/*
 * File: app/controller/WinAddRowController.js
 *
 * This file was generated by Sencha Architect version 4.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('M_GR_BC_RET_HSPF.controller.WinAddRowController', {
    extend: 'Ext.app.Controller',

    control: {
        "#popSelectBtn": {
            click: 'popSelectBtnClick'
        },
        "[cls=pop_search]": {
            specialkey: 'popEnter'
        },
        "#popGrid": {
            celldblclick: 'onGridpanelCellDblClick'
        }
    },

    popSelectBtnClick: function(button, e, eOpts) {
        var store = Ext.getStore('PopStore');
        store.load({
        	params:{
        		V_TYPE : 'POP_S',
        		V_GR_DT : Ext.getCmp('V_GR_DT').getValue(),
        		V_LOT_NO : Ext.getCmp('V_LOT_NO').getValue(),
        		V_BC_NO : Ext.getCmp('V_BC_NO').getValue(),
        		V_ITEM_NM : Ext.getCmp('V_ITEM_NM').getValue(),
        	}
        })
    },
    
    popEnter: function(field, e, eOpts) {
    	if (e.getKey() == e.ENTER) {
    		this.popSelectBtnClick();
    	}
    },
    
    onGridpanelCellDblClick: function(tableview, td, cellIndex, record, tr, rowIndex, e, eOpts) {
        	
        var store = Ext.getStore('MyStore');
        
        var nows = new Date();
        var rec = Ext.create('M_GR_BC_RET_HSPF.model.MyModel', {
        	CFM_YN : 'N',
        	RE_DT : nows,
        	M_BP_CD : record.data['BP_CD'],
        	M_BP_NM : record.data['BP_NM'],
        	ITEM_CD : record.data['ITEM_CD'],
        	ITEM_NM : record.data['ITEM_NM'],
        	PAL_BC_NO : record.data['PAL_BC_NO'],
        	BOX_BC_NO : record.data['BOX_BC_NO'],
        	LOT_BC_NO : record.data['LOT_BC_NO'],
        	RE_QTY : record.data['GR_QTY'],
		});
        
        store.insert(0, rec);
        
        Ext.getCmp('popWindow').destroy();
    }

});
