/*
 * File: app/view/MyPanel.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Y_APPROV_STEEL.view.MyPanel', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.mypanel',

    requires: [
        'Y_APPROV_STEEL.view.MyPanelViewModel',
        'Ext.form.Panel',
        'Ext.form.FieldSet',
        'Ext.form.FieldContainer',
        'Ext.form.field.Text',
        'Ext.grid.Panel',
        'Ext.grid.column.RowNumberer',
        'Ext.grid.column.Number',
        'Ext.view.Table',
        'Ext.selection.CheckboxModel',
        'Ext.grid.plugin.Exporter',
        'Ext.grid.plugin.CellEditing',
        'Ext.resizer.Splitter',
        'Ext.grid.plugin.Clipboard',
    ],

    viewModel: {
        type: 'mypanel'
    },
    itemId: 'mypanel',
    layout: 'fit',
    header: false,
    title: 'Tab 1',

    items: [
        {
            xtype: 'container',
            flex: 1,
            layout: {
                type: 'vbox',
                align: 'stretch'
            },
            items: [
                {
                    xtype: 'form',
                    layout: 'auto',
                    bodyPadding: '0 10 0 10',
                    header: false,
                    title: 'My Form',
                    items: [
                        {
                        	hidden: true,
                            xtype: 'fieldset',
                            height: 100,
                            maxHeight: 100,
                            minHeight: 100,
                            collapsible: true,
                            title: '[ Search ]',
                            layout: {
                                type: 'vbox',
                                align: 'stretch',
                                pack: 'center'
                            },
                            items: [
                                {
                                    xtype: 'fieldcontainer',
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '품의번호',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            hidden: true,
                                            id: 'S_APPROV_NO'
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '품의명',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            hidden: true,
                                            id: 'S_APPROV_NM'
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '차수',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'S_APPROV_SEQ',
                                            hidden: true
                                        },
                                        
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'fieldset',
                            height: 180,
                            maxHeight: 180,
                            minHeight: 180,
                            collapsible: true,
                            title: '[ 품의등록정보 ]',
                            layout: {
                                type: 'vbox',
                                align: 'stretch',
                                pack: 'center'
                            },
                            items: [
                                    {
                                    	xtype: 'fieldcontainer',
                                    	layout: {
                                    		type: 'hbox',
                                    		align: 'stretch'
                                    	},
                                    	items: [
											{
											    xtype: 'textfield',
											    maxWidth: 250,
											    minWidth: 250,
											    width: 250,
											    fieldLabel: '리스크관리번호',
											    name: 'search_field',
											    id: 'V_RISK_REF_NO',
											    emptyText: '(Double Click)',
											    listeners: {
											        afterrender: function(c) {
											        	
											        	c.getEl().on('dblclick', function() {
											        		var popup = Ext.create("Y_APPROV_STEEL.view.WinRiskPop");
											                
											                popup.setSize(Ext.getBody().getViewSize());
											                popup.show();
											                
											                var store = Ext.getStore('PopStore');
											                Y_APPROV_STEEL.app.getController("RiskPopController").w_riskSelBtnClick();
											                
											            });
											        }
											    }
											},
											{
	                                        	xtype: 'textfield',
	                                        	margin: '0 0 0 30',
	                                        	maxWidth: 230,
	                                        	minWidth: 230,
	                                        	width: 230,
	                                        	fieldLabel: '발주 유부',
	                                        	labelWidth: 80,
	                                        	id: 'V_PO_YN',
	                                        	editable: false,
	                                        	hidden: true
	                                        },
											{
												xtype: 'numberfield',
												id: 'V_KRW_RATE',
												flex: 1,
												maxWidth: 230,
												minWidth: 230,
												width: 230,
												fieldLabel: '<span style=\'color:red\'>*</span>KRW 환율',
												labelWidth: 80,
												format: '0,000',
												value: 1,
												hidden: true
											},
											{
	                                            xtype: 'numberfield',
	                                            id: 'V_USD_RATE',
	                                            flex: 1,
	                                            maxWidth: 230,
	                                            minWidth: 230,
	                                            width: 230,
	                                            fieldLabel: '<span style=\'color:red\'>*</span>USD 환율',
	                                            labelWidth: 80,
	                                            format: '0,000.00',
	                                            value: 1,
	                                            hidden: true
	                                        },
	                                        {
	                                        	xtype: 'numberfield',
	                                        	id: 'V_JPY_RATE',
	                                        	flex: 1,
	                                        	maxWidth: 230,
	                                        	minWidth: 230,
	                                        	width: 230,
	                                        	fieldLabel: '<span style=\'color:red\'>*</span>JPY 환율',
	                                        	labelWidth: 80,
	                                        	format: '0,000.00',
	                                        	editable: false,
	                                        	value: 1,
	                                        	hidden: true
	                                        },
	                                        {
	                                        	xtype: 'numberfield',
	                                        	id: 'V_CNY_RATE',
	                                        	flex: 1,
	                                        	maxWidth: 230,
	                                        	minWidth: 230,
	                                        	width: 230,
	                                        	fieldLabel: '<span style=\'color:red\'>*</span>CNY 환율',
	                                        	labelWidth: 80,
	                                        	format: '0,000.00',
	                                        	editable: false,
	                                        	value: 1,
	                                        	hidden: true
	                                        },
	                                        {
	                                        	xtype: 'numberfield',
	                                        	id: 'V_EUR_RATE',
	                                        	flex: 1,
	                                        	maxWidth: 230,
	                                        	minWidth: 230,
	                                        	width: 230,
	                                        	fieldLabel: '<span style=\'color:red\'>*</span>EUR 환율',
	                                        	labelWidth: 80,
	                                        	format: '0,000.00',
	                                        	editable: false,
	                                        	value: 1,
	                                        	hidden: true
	                                        },
	                                        {
	                                        	xtype: 'numberfield',
	                                        	id: 'V_RISK_PROFIT',
	                                        	flex: 1,
	                                        	maxWidth: 230,
	                                        	minWidth: 230,
	                                        	width: 230,
	                                        	fieldLabel: '리스크 이익',
	                                        	labelWidth: 80,
	                                        	format: '0,000.00',
	                                        	value: 0,
	                                        	editable: false,
	                                        	hidden: true
	                                        },
											]
                                    },
                                {
                                    xtype: 'fieldcontainer',
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            maxWidth: 250,
                                            minWidth: 250,
                                            width: 250,
                                            fieldLabel: '품의관리번호',
                                            name: 'search_field',
                                            id: 'V_APPROV_MGM_NO',
                                            emptyText: '(Double Click)',
                                            listeners: {
                                                afterrender: function(c) {
                                                	c.getEl().on('dblclick', function() {
                                                		var popup = Ext.create("Y_APPROV_STEEL.view.WinApprovPop");
                                                        
                                                        popup.setSize(Ext.getBody().getViewSize());
                                                        popup.show();
                                                        
                                                        Y_APPROV_STEEL.app.getController("ApprovPopController").w_approvSelBtnClick();
                                                    });
                                                }
                                            },
                                            fieldStyle: 'background-color: #ffefbb'
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_S_BP_CD',
                                            hidden: true
                                        },
                                        {
                                        	xtype: 'textfield',
                                        	margin: '0 0 0 30',
                                        	maxWidth: 230,
                                        	minWidth: 230,
                                        	width: 230,
                                            fieldLabel: '<span style=\'color:red\'>*</span>수주처',
                                        	labelWidth: 80,
                                        	name: 'search_field',
                                        	id: 'V_S_BP_NM',
                                            emptyText: '(Double Click)',
                                            listeners: {
                                                afterrender: function(c) {
                                                	c.getEl().on('dblclick', function() {
                                            			var popup = Ext.create("Popup.view.WinSBpPop");
                                            			popup.show();
                                            			
                                            			Ext.getCmp('fieldType').setValue('Y_APPROV_STEEL');
                                            			var store = Ext.getStore('WinSBpPopStore');
                                            			store.removeAll();
                                                    });
                                                },
                                                change: function(field, newValue, oldValue, eOpts) {
                                                	if(newValue.length == 0) {
                                                		Ext.getCmp('V_S_BP_CD').setValue('');
                                                	}
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '<span style=\'color:red\'>*</span>품의번호',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_APPROV_NO'
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '<span style=\'color:red\'>*</span>품의차수',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_APPROV_SEQ'
                                        },
                                        {
                                            xtype: 'textfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 400,
                                            minWidth: 400,
                                            width: 400,
                                            fieldLabel: '<span style=\'color:red\'>*</span>품의명',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_APPROV_NM',
//                                            editable: false
                                        }
                                    ]
                                },
                                {
                                    xtype: 'fieldcontainer',
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch'
                                    },
                                    items: [
                                        {
                                            xtype: 'datefield',
                                            maxWidth: 250,
                                            minWidth: 250,
                                            width: 250,
                                            fieldLabel: '<span style=\'color:red\'>*</span>품의일자',
                                            name: 'search_field',
                                            id: 'V_APPROV_DT',
                                            format: 'Y-m-d',
                                            altFormats: 'm/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j|Ymd',
                                            listeners : {
                                                render : function(datefield) {
                                                	var nows = new Date();
                                                    datefield.setValue(nows);
                                                },
                                                change : function () {
                                    				Ext.Ajax.request({
                                    					url : '/HSPF01/common/sql/ERP_DB.jsp',
                                    					method : 'post',
                                    					params: {
                                    						V_TYPE: 'XCH_RT_ALL',
                                    						V_DATE : Ext.getCmp('V_APPROV_DT').getValue(),
                                    						V_CUR : 'ALL',
                                    						V_COMP_ID : parent.Ext.getCmp('GCOMP_ID').getValue(),
                                    						V_USR_ID : parent.Ext.getCmp('GUSER_ID').getValue(),
                                    					},
                                    					success: function(response) {
                                    						var res = response.responseText;
                                    						var jResult =  Ext.JSON.decode(res);
                                    						
                                    						for(var i = 0 ; i < jResult.resultList.length ; i ++){
                                    							Ext.getCmp('V_' + jResult.resultList[i].FROM_CURRENCY +'_RATE').setValue(jResult.resultList[i].STD_RATE);
                                    						}
                                    						
                                    						var store = Ext.getCmp('myGrid').getStore();
                                    						var record = store.getRange();
                                    						
                                    						for(var i = 0 ; i < record.length ; i ++){
                                    							record[i].set('XCH_RATE', Ext.getCmp('V_' + record[i].get('CUR') + '_RATE').getValue());
                                    						}
                                    						
                                    					}
                                    				});
                                                }
                                            },
                                        },
                                        {
                                            xtype: 'combobox',
                                            margin: '0 0 0 30',
                                            maxWidth: 230,
                                            minWidth: 230,
                                            width: 230,
                                            fieldLabel: '<span style=\'color:red\'>*</span>사업부구분',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_COMP_TYPE',
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	editable: false,
                            	        	value: 'B',
                            	        	store: Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store1',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA25',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM} ({DTL_CD})</div>'
                                                ]
                                            },
                                        },
                                        {
                                            xtype: 'combobox',
                                            margin: '0 0 0 30',
                                            maxWidth: 180,
                                            minWidth: 180,
                                            width: 180,
                                            fieldLabel: '<span style=\'color:red\'>*</span>지역',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_REGION',
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	editable: false,
                            	        	value: 8,
                            	        	store: Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store2',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA26',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM} ({DTL_CD})</div>'
                                                ]
                                            },
                                        },
                                        {
                                            xtype: 'combobox',
                                            margin: '0 0 0 30',
                                            maxWidth: 180,
                                            minWidth: 180,
                                            width: 180,
                                            fieldLabel: '판매유형',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_SALE_TYPE',
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	editable: false,
                            	        	store: Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store3',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA10',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM} ({DTL_CD})</div>'
                                                ]
                                            },
                                        },
                                        {
                                            xtype: 'combobox',
                                            margin: '0 0 0 30',
                                            maxWidth: 180,
                                            minWidth: 180,
                                            width: 180,
                                            fieldLabel: '구매유형',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_IV_TYPE',
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	editable: false,
                            	        	store: Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store4',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA18',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM} ({DTL_CD})</div>'
                                                ]
                                            },
                                            listeners: {
                                            	select : function(combo, record, eOpts) {
                                            		/*
                                            		if(record.data.DTL_CD == 'L') { //내수
                                            			Ext.getCmp('myGrid').down('[dataIndex=USANCE_TYPE]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=USANCE_RT]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=CONT_QTY]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=CONT_REMARK]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=INSUR_RT]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=REC_RT]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=LC_RT]').setVisible(false);
                                            			Ext.getCmp('myGrid').down('[dataIndex=PAY_METH]').setVisible(false);
                                            			
                                            		} else {
                                            			Ext.getCmp('myGrid').down('[dataIndex=USANCE_TYPE]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=USANCE_RT]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=CONT_QTY]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=CONT_REMARK]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=INSUR_RT]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=REC_RT]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=LC_RT]').setVisible(true);
                                            			Ext.getCmp('myGrid').down('[dataIndex=PAY_METH]').setVisible(true);
                                            			
                                            		}
                                            		*/
                                            	}
                                            },
                                        },
                                        {
                                            xtype: 'numberfield',
                                            margin: '0 0 0 30',
                                            maxWidth: 180,
                                            minWidth: 180,
                                            width: 180,
                                            fieldLabel: '컨테이너수량',
                                            labelWidth: 80,
                                            name: 'search_field',
                                            id: 'V_CONT_QTY',
                                            hidden: true
                                        },
                                        {
                                            xtype: 'combobox',
//                                            flex: 1,
//                                            maxWidth: 150,
//                                            minWidth: 150,
                                            width: 150,
                                            margin: '0 0 0 30',
                                            fieldLabel: '이익',
                                            labelWidth: 40,
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	id: 'V_PROFIT_TYPE',
                            	        	editable: false,
                            	        	store: Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store3',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA22-2',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM} ({DTL_CD})</div>'
                                                ]
                                            },
                                        },
                                        {
                                            xtype: 'textfield',
//                                            maxWidth: 60,
//                                            minWidth: 60,
                                            width: 60,
//                                            labelWidth: 50,
//                                            margin: '0 0 0 30',
//                                            fieldLabel: '이익',
                                            id: 'V_PROFIT_RT',
                                            fieldStyle: 'text-align: right',
                                        },
                                        
                                        {
                                            xtype: 'combobox',
//                                            maxWidth: 90,
//                                            minWidth: 90,
                                            width: 90,
                                            margin: '0 0 0 -10',
                                            displayField: 'DTL_NM',
                            	        	valueField: 'DTL_CD',
                            	        	id: 'V_PROFIT_UNIT',
                            	        	editable: false,
                            				store : Ext.create('Ext.data.Store',{
                            	        		autoLoad: true,
                            	        		storeId: 'store_unit',
                            	        		proxy: {
                            	        			type: 'ajax',
                            	        			extraParams: {
                            	        				V_MAST_CD: 'BA40',
                            	        				V_GRID: 'Y'
                            	        			},	
                            	        			api: {
                            	        				read: '/HSPF01/common/sql/Combobox.jsp'
                            	        			},
                            	        			reader: {
                            	        				type: 'json',
                            	        				rootProperty: 'resultList'
                            	        			}
                            	        		}
                            	        	})
                            	        	,
                                    		listConfig: {
                                                itemTpl: [
                                                    '<div>{DTL_NM}</div>'
                                                ]
                                            },
                                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                                if(Ext.data.StoreManager.lookup('store_unit').findRecord('DTL_CD',value) !==null)
                                                {
                                                    return Ext.data.StoreManager.lookup('temp').findRecord('DTL_CD',value).get('DTL_NM');
                                                }
                                                return value;
                                            },
                                        },
                                        
                                        
                                        
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    xtype: 'gridpanel',
                    flex: 1,
                    style: 'border: 1px solid lightgray; padding: 5px;',
                    header: false,
                    title: 'My Grid Panel',
                    id: 'myGrid',
                    store: 'MyStore',
                    
                        tbar: [
                               {
                                   id: 'gridAddBtn',
                                   text: '',
                                   margin: '0 3 0 0',
                                   glyph: 'xf055@FontAwesome',
                                   iconCls: 'grid-add-btn',
                               },
                               {
                                   id: 'gridDelBtn',
                                   text: '',
                                   margin: '0 3 0 0',
                                   glyph: 'xf056@FontAwesome',
                                   iconCls: 'grid-del-btn',
                               },
                               {
	                               	id: 'gridSaveBtn',
	                               	xtype: 'button',
	                               	glyph: 'xf0c7@FontAwesome',
	                               	iconCls: 'grid-save-btn',
	                               	margin: '0 3 0 0'
                               },
                               {
                            	   id: 'gridCopyBtn',
                            	   xtype: 'button',
                            	   glyph: 'xf0c5@FontAwesome',
                            	   iconCls: 'grid-copy-btn',
                            	   margin: '0 3 0 0'
                               },
                               {
                                   xtype: 'container',
                                   flex: 1
                               },
                               {
                                   xtype: 'button',
                                   glyph: 'xf1c3@FontAwesome',
                                   id: 'xlsxDown1',
                                   cfg: {
                                       type: 'excel07',
                                       ext: 'xlsx'
                                   },
                                   iconCls: 'grid-excel-btn',
                               }
                           ],
                    columns: [
                        {
                            xtype: 'rownumberer',
                            width: 40
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'V_TYPE',
                            text: 'V_TYPE',
                            hidden: true
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                        	width: 114,
                        	dataIndex: 'ITEM_CD',
                        	text: '품목그룹코드',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 114,
                        	dataIndex: 'ITEM_NM',
                        	text: '<span style=\'color:red\'>*</span>품목그룹명',
                        	editor : {
                    			xtype : 'textfield',
                    			allowBlank : false,
                    			emptyText : '(Double Click)',
                    			editable : false,
                    			listeners : {
                    				afterrender : function(c) {
                    					c.getEl().on('dblclick', function() {
                    						var popup = Ext.create("Y_APPROV_STEEL.view.MyWindow");
                    						
//                    						var width = Ext.getBody().getViewSize().width - 600;
//                    						var height = Ext.getBody().getViewSize().height - 200;
//                    						popup.setSize(width, height);
                    						popup.center();
                    						
                    						popup.show();
                    						
                    						var store = Ext.getStore('MeatStore');
                    						store.removeAll();
                    						
                    						var gridRecord = Ext.getCmp('myGrid').getSelectionModel().getSelection();
                    					});
                    				}
                    			}
                    		},
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                        	width: 114,
                        	dataIndex: 'S_BP_CD',
                        	text: '매출처코드',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                        	width: 114,
                        	dataIndex: 'S_BP_NM',
                        	text: '매출처명',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                        	width: 100,
                        	dataIndex: 'S_',
                        	text: '차수',
                        	hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6' ,
                            width: 114,
                            dataIndex: 'M_BP_CD',
                            text: '<span style=\'color:red\'>*</span>매입처코드',
                    		editor : {
                    			xtype : 'textfield',
                    			allowBlank : false,
                    			emptyText : '(Double Click)',
//                    			editable : false,
                    			listeners : {
                    				afterrender : function(c) {
                    					c.getEl().on('dblclick', function() {
                    						var popup = Ext.create("Popup.view.WinMBpPop");
                    						popup.show();
                    						
                    						Ext.getCmp('fieldType').setValue('Y_APPROV_STEEL');
                    						var store = Ext.getStore('WinMBpPopStore');
                    						store.removeAll();
                    					});
                    				}
                    			}
                    		},
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 150,
                            dataIndex: 'M_BP_NM',
                            text: '매입처명'
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;  color: #3367d6',
                        	width: 200,
                        	dataIndex: 'M_BP_DESC',
                        	text: '<span style=\'color:red\'>*</span>매입품의명',
                        	editor: {
                        		xtype: 'textfield'
                        	}
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;  color: #3367d6',
                        	width: 110,
                        	dataIndex: 'M_BP_SEQ',
                        	text: '<span style=\'color:red\'>*</span>매입품의차수',
                        	format: '0,000',
                        	editor: {
                        		xtype: 'numberfield',
                        		minValue: 1
                        	}
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 114,
                            dataIndex: 'BRAND',
                            text: 'BRAND',
                        	editor: {
                        		xtype: 'textfield'
                        	}
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 114,
                            dataIndex: 'CUR',
                            text: '<span style=\'color:red\'>*</span>외화단위',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'storecur',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA04',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('storecur').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('storecur').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'XCH_RATE',
                            text: '환율',
                            format: '0,000.00',
                            editor: {
                            	xtype: 'numberfield',
                            	forcePrecision: true,    
                            	decimalPrecision: 4   
                            },
//                        	hidden: true
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'PO_QTY',
                            text: '<span style=\'color:red\'>*</span>발주수량',
                            editor: {
                                xtype: 'numberfield',
                                allowBlank: false,
                                allowExponential: false,
                                minValue: 0
                            },
                            summaryType: 'sum',
                            summaryRenderer: function(value, summaryData, dataIndex) {
                                return "<font color='green'>"+Ext.util.Format.number(value, '0,000.00')+"<font>"; 
                            }
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'PO_AMT',
                            text: '<span style=\'color:red\'>*</span>발주금액',
                            format: '0,000.00',
                            summaryType: 'sum',
                            summaryRenderer: function(value, summaryData, dataIndex) {
                                return "<font color='green'>"+Ext.util.Format.number(value, '0,000.00')+"<font>"; 
                            },
                            editor: {
                                xtype: 'numberfield',
                                allowBlank: false,
                                allowExponential: false,
                                decimalPrecision: 6,
                            },
                            width: 150
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 250,
                            dataIndex: 'USANCE_TYPE',
                            text: '<span style=\'color:red\'>*</span>USANCE조건',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'store4',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'USANCE',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('store4').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('store4').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 110,
                        	align: 'end',
                        	dataIndex: 'USANCE_RT',
                        	text: 'USANCE 이자율',
                        	editor: {
                        		xtype: 'numberfield',
                        		allowBlank: false,
                        		allowExponential: false,
                        	} ,
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 135,
                            dataIndex: 'USANCE_CLS',
                            text: 'USANCE구분',
                            align: 'center',
                            value: 'A',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'store5',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA29-2',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('store5').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('store5').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 110,
                        	align: 'end',
                        	dataIndex: 'LC_RT',
                        	text: 'LC개설비요율',
                        	editor: {
                        		xtype: 'numberfield',
                        		allowBlank: false,
                        		allowExponential: false,
                        	},
//                        	hidden: true
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 110,
                        	align: 'end',
                        	dataIndex: 'REC_RT',
                        	text: '인수수수료요율',
                        	editor: {
                        		xtype: 'numberfield',
                        		allowBlank: false,
                        		allowExponential: false,
                        	} ,
//                        	hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 135,
                            dataIndex: 'REC_CLS',
                            text: '인수수수료구분',
                            align: 'center',
                            value: 'B',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'store6',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA29-2',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('store6').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('store6').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'INSUR_RT',
                            text: '보험요율',
                            format: '0,000.000',
                            editor: {
                            	xtype: 'numberfield',
                            	format: '0,000.000',
                            	forcePrecision: true,    
                            	decimalPrecision: 3    
                            },
//                        	hidden: true
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'TAX_RT',
                            text: '관세율',
                            editor: {
                                xtype: 'numberfield',
                                allowBlank: false,
                                allowExponential: false,
                            },
//                        	hidden: true 
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	align: 'end',
                        	dataIndex: 'COMMISSION_RT',
                        	text: '커미션수수료요율',
                        	width: 130,
                        	editor: {
                        		xtype: 'numberfield',
                        		allowBlank: false,
                        		allowExponential: false,
                        	},
//                        	hidden: true 
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 250,
                            dataIndex: 'PAY_METH',
                            text: '<span style=\'color:red\'>*</span>가격조건',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'storeea',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'MA04',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('storeea').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('storeea').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; ',
                        	align: 'end',
                        	dataIndex: 'INSUR_RT',
                        	text: '매출금액',
                        	format: '0,000.00',
                        	hidden: true
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 100,
                        	dataIndex: 'SL_LOC',
                        	text: '창고',
                        	hidden: true,
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'storesloc',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA31-1',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('storesloc').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('storesloc').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                       
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	width: 250,
                        	dataIndex: 'REMARK',
                        	text: '비고',
                        	editor: {
                        		xtype: 'textfield'
                        	}
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                        	width: 170,
                        	dataIndex: 'PO_NO',
                        	text: '발주번호',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; ',
                        	dataIndex: 'PO_SEQ',
                        	text: '발주순번',
                        },
                    ],
                    viewConfig: {
                    	enableTextSelection: true,
                    },
                    selModel: {
                        selType: 'checkboxmodel',
                        listeners: {
                        	select: function(rowmodel, record, index, eOpts) {
                            	record.set('V_TYPE', 'V');
                            },
                            deselect: function(rowmodel, record, index, eOpts) {
                            	record.set('V_TYPE', '');
                            }
                        }
                    },
                    plugins: [
                        {
                            ptype: 'gridexporter'
                        },
                        {
                            ptype: 'clipboard'
                        },
                        {
                            ptype: 'cellediting',
                            clicksToEdit: 2,
                            listeners: {
                            	edit: function(editor, context, eOpts) {
                            		var selModel = Ext.getCmp('myGrid').getSelectionModel();
                            		selModel.select(context.record, true);
                            		
                            		var PO_QTY = context.record.get('PO_QTY'); 
                            		var PO_PRC = context.record.get('PO_PRC'); 
                            		var PO_AMT = context.record.get('PO_AMT'); 
                            		
                            		if ((context.column.dataIndex == 'PO_QTY' ||
                        				context.column.dataIndex == 'PO_AMT'	) 
                            			&& (PO_QTY != undefined) 
                            			&& (PO_AMT != undefined)) {
                            			context.record.set('PO_PRC', PO_AMT / PO_QTY);
                            		}
                            		if(context.column.dataIndex == 'CUR'){
                            			context.record.set('XCH_RATE',Ext.getCmp('V_' + context.value + '_RATE').getValue());
                            		}
                            		if(context.column.dataIndex == 'USANCE_CLS'){
                            			var store = Ext.getCmp('myGrid').getStore();
                            			var record = store.getRange();
                            			for(var i = 0 ; i < record.length ; i ++){
                            				record[i].set('USANCE_CLS', context.value);
                            			}
                            		}
                            		if(context.column.dataIndex == 'REC_CLS'){
                            			var store = Ext.getCmp('myGrid').getStore();
                            			var record = store.getRange();
                            			for(var i = 0 ; i < record.length ; i ++){
                            				record[i].set('REC_CLS', context.value);
                            			}
                            		}
                            	},
                            	afteredit: function(editor, context, eOpts) {
                            		
                            		//축종
                            		
                            		//원산지
                            		
                            		//등급
                            		

                            		var selModel = Ext.getCmp('myGrid').getSelectionModel();
                            		selModel.select(context.record, true);
                            		
                            		var PO_QTY = context.record.get('PO_QTY'); 
                            		var PO_PRC = context.record.get('PO_PRC'); 
                            		var PO_AMT = context.record.get('PO_AMT'); 
                            		
                            		if ((context.column.dataIndex == 'PO_QTY' ||
                        				context.column.dataIndex == 'PO_AMT'	) 
                            			&& (PO_QTY != undefined) 
                            			&& (PO_AMT != undefined)) {
                            			context.record.set('PO_PRC', PO_AMT / PO_QTY);
                            		}
                            		if(context.column.dataIndex == 'CUR'){
                            			
                            		}
                            	
                            		
                            	},
                            	beforeedit: function(editor, context, eOpts) {
//                            		if(context.column.dataIndex=='GRADE') {
//                            			var MAST_CD = '';
//                            			if(context.record.get('ORIGIN') == 'U') { //미국
//                            				MAST_CD = 'BA15';
//                            			} else if(context.record.get('ORIGIN') == 'A') {//호주
//                            				MAST_CD = 'BA16';
//                            			} else if(context.record.get('ORIGIN') == 'N') {//뉴질랜드
//                            				MAST_CD = 'BA17';
//                            			}
//                            			
//                            			var storeGrade = Ext.getStore('GradeStore');
//                            			var gradeCombo = Ext.getCmp('gradeCombo');
//                            			
//                            			storeGrade.load(
//                            					{   
//                            						params: 
//                            						{
//                            							V_MAST_CD : MAST_CD,
//                            							V_GRID: 'Y' 
//                            						},
//                            					});
//                            			
//                            		}
                            		
                            		
                            	}
                        	}
                        }
                    ],
                    features: [
                               {
                                   ftype: 'summary'
                               }
                            ],
                },
                {
                    xtype: 'splitter',
                    height: 10
                },
                {
                	id: 'myGrid1',
                    xtype: 'gridpanel',
                    flex: 1,
                    style: 'border: 1px solid lightgray; padding: 5px;',
                    header: false,
                    title: 'My Grid Panel',
                    store: 'MyStore1',
                    sortableColumns: false,
                    tbar: [
                           {
                               id: 'gridAddBtn1',
                               text: '',
                               margin: '0 3 0 0',
                               glyph: 'xf055@FontAwesome',
                               iconCls: 'grid-add-btn',
                               disabled: true
                           },
                           {
                               id: 'gridDelBtn1',
                               text: '',
                               margin: '0 3 0 0',
                               glyph: 'xf056@FontAwesome',
                               iconCls: 'grid-del-btn',
                               disabled: true
                           },
                           {
                               	id: 'gridSaveBtn1',
                               	xtype: 'button',
                               	glyph: 'xf0c7@FontAwesome',
                               	iconCls: 'grid-save-btn',
                               	margin: '0 3 0 0'
                           },
                           {
                               xtype: 'container',
                               flex: 1
                           },
                           {
                               xtype: 'button',
                               glyph: 'xf1c3@FontAwesome',
                               id: 'xlsxDown2',
                               cfg: {
                                   type: 'excel07',
                                   ext: 'xlsx'
                               },
                               iconCls: 'grid-excel-btn',
                           }
                       ],
                    columns: [
                        {
                            xtype: 'rownumberer',
                            width: 40
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'V_TYPE',
                            text: 'V_TYPE',
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            text: '거래단계',
                            columns: [
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    dataIndex: 'TYPE_NM',
                                    text: '구분1'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    dataIndex: 'COGS_NM',
                                    width: 250,
                                    text: '구분2'
                                }
                            ]
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 114,
                            dataIndex: 'COGS_CUR',
                            text: '화폐단위',
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'storecur1',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA04',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        		listConfig: {
                                    itemTpl: [
                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                    ]
                                },
                                listeners: {
                                	change: function(field, newValue, oldValue, eOpts) {
                                		var store = Ext.getStore('MyStore1');
                                		store.each(function(record, idx) {
                                			record.set('COGS_CUR', newValue);
                                		});
                                    }
                                }
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('storecur1').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('storecur1').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'COGS_AMT',
                            text: '금액',
                            format: '0,000.00',
                            editor: {
                            	xtype: 'numberfield'
                            },
                            listeners: {
                            	change: function(field, newValue, oldValue, eOpts) {
                            		var store = Ext.getStore('MyStore1');
                            		store.each(function(record, idx) {
                            			record.set('COGS_CUR', newValue);
                            		});
                                }
                            },
                            width: 150
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                        	align: 'end',
                        	dataIndex: 'LOC_AMT',
                        	text: '자국금액',
                        	format: '0,000',
                        	editor: {
                        		xtype: 'numberfield'
                        	},
                        	width: 150
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                            width: 300,
                            dataIndex: 'REMARK',
                            text: '비고',
                            editor: {
                            	xtype: 'textfield'
                            }
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'AG_IN_TYPE',
                            text: '수입대행', 
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'AG_IV_TYPE',
                            text: '구매대행',
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'DR_IN_TYPE',
                            text: '수입',
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'DR_BL_TYPE',
                            text: 'B/L양수도',
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                            width: 114,
                            dataIndex: 'DR_JI_TYPE',
                            text: '직판내수',
                            hidden: true
                        }
                    ],
                    viewConfig: {
                    	enableTextSelection: true,
                        },
                    selModel: {
                        selType: 'checkboxmodel'
                    },
                    plugins: [
                        {
                            ptype: 'gridexporter'
                        },
                        {
                            ptype: 'cellediting',
                            clicksToEdit: 1,
                            listeners: {
                            	edit: function(editor, context, eOpts) {
                            		var selModel = Ext.getCmp('myGrid').getSelectionModel();
                            		selModel.select(context.record, true);
                            		
                            		var COGS_AMT = context.record.get('COGS_AMT');
                            		var COGS_CUR = context.record.get('COGS_CUR'); 
                            		var LOC_AMT = context.record.get('LOC_AMT'); 
                            		
                            		var record = Ext.getCmp('myGrid').getStore().getRange();
                            		
                            		if(context.column.dataIndex == 'COGS_AMT'){
                            			context.record.set('LOC_AMT',record[0].data['XCH_RATE'] * COGS_AMT );
                            		}
                            		
                            		if(context.column.dataIndex == 'LOC_AMT'){
                            			context.record.set('COGS_AMT',LOC_AMT / record[0].data['XCH_RATE'] );
                            		}
                            		
                            	},
                            }
                        }
                    ]
                }
            ]
        }
    ]

});