/*
 * File: app/view/MyViewport.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('M_GR_STEEL2.view.MyViewport', {
    extend: 'Ext.container.Viewport',
    alias: 'widget.myviewport',

    requires: [
        'M_GR_STEEL2.view.MyViewportViewModel',
        'M_GR_STEEL2.view.MyViewportViewController',
        'Ext.button.Button',
        'Ext.form.Panel',
        'Ext.form.FieldSet',
        'Ext.form.FieldContainer',
        'Ext.form.field.Date',
        'Ext.grid.Panel',
        'Ext.grid.column.RowNumberer',
        'Ext.grid.column.Number',
        'Ext.grid.column.Date',
        'Ext.view.Table',
        'Ext.selection.CheckboxModel',
        'Ext.grid.plugin.Exporter',
        'Ext.grid.plugin.CellEditing',
        'Ext.resizer.Splitter'
    ],

    controller: 'myviewport',
    viewModel: {
        type: 'myviewport'
    },
    height: 250,
    style: 'background-color: white',
    width: 400,

    layout: {
        type: 'vbox',
        align: 'stretch'
    },
    items: [
        {
            xtype: 'container',
            margin: '11 0 1 8',
            items: [
                {
                    xtype: 'button',
                    id: 'selBtn',
                    margin: '0 3 0 0',
                    maxWidth: 80,
                    minWidth: 80,
                    width: 80,
                    glyph: 'xf002@FontAwesome',
                    text: '조회'
                },
                {
                    xtype: 'button',
                    id: 'saveBtn',
                    margin: '0 3 0 0',
                    maxWidth: 80,
                    minWidth: 80,
                    width: 80,
                    glyph: 'xf0c7@FontAwesome',
                    text: '저장',
                    disabled: true,
                },
                {
                    xtype: 'button',
                    id: 'clrBtn',
                    margin: '0 3 0 0',
                    maxWidth: 80,
                    minWidth: 80,
                    width: 80,
                    glyph: 'xf011@FontAwesome',
                    text: '초기화'
                },
                {
                    xtype: 'button',
                    id: 'clsBtn',
                    margin: '0 3 0 0',
                    maxWidth: 80,
                    minWidth: 80,
                    width: 80,
                    glyph: 'xf00d@FontAwesome',
                    text: '닫기'
                }
            ]
        },
        {
            xtype: 'container',
            flex: 1,
            padding: '0 10 0 10',
            layout: {
                type: 'vbox',
                align: 'stretch',
                pack: 'center'
            },
            items: [
                {
                    xtype: 'container',
                    flex: 0.8,
                    layout: {
                        type: 'vbox',
                        align: 'stretch'
                    },
                    items: [
                        {
                            xtype: 'form',
                            layout: 'auto',
                            bodyPadding: '0 10 0 10',
                            header: false,
                            title: 'My Form',
                            items: [
                                {
                                    xtype: 'fieldset',
                                    height: 100,
                                    maxHeight: 100,
                                    minHeight: 100,
                                    title: '[ Search ]',
                                    layout: {
                                        type: 'vbox',
                                        align: 'stretch',
                                        pack: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'fieldcontainer',
                                            layout: {
                                                type: 'hbox',
                                                align: 'stretch'
                                            },
                                            items: [
												{
												    xtype: 'datefield',
												    maxWidth: 250,
												    minWidth: 250,
												    width: 250,
												    fieldLabel: '발주일자',
												    format: 'Y-m-d',
												    altFormats: 'm/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j|Ymd',
												    listeners: {
												        render: {
												            fn: 'onDatefieldRender',
												            single: false
												        }
												    }, 
												    id: 'V_PO_DT_FR'
												},
												{
												    xtype: 'datefield',
												    flex: 1,
												    maxWidth: 170,
												    minWidth: 170,
												    width: 170,
												    fieldLabel: '~',
												    format: 'Y-m-d',
												    altFormats: 'm/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j|Ymd',
												    labelWidth: 20,
												    listeners: {
												        render: 'onDatefieldRender1'
												    }, 
												    id: 'V_PO_DT_TO'
												},
												{
                                                    xtype: 'textfield',
                                                    margin: '0 0 0 30',
                                                    maxWidth: 200,
                                                    minWidth: 200,
                                                    width: 200,
                                                    labelWidth: 60,
                                                    fieldLabel: '매입처',
                                                    name: 'search_field',
                                                    blankText: '',
                                                    emptyText: '(Double Click)',
                                                    id: 'V_M_BP_NM',
                                                    listeners: {
                                                        afterrender: function(c) {
                                                        	c.getEl().on('dblclick', function() {
                                                    			var popup = Ext.create("Popup.view.WinMBpPop");
                                                    			popup.show();
                                                    			
                                                    			Ext.getCmp('fieldType').setValue('M_GR_STEEL22');
                                                    			var store = Ext.getStore('WinMBpPopStore');
                                                    			store.removeAll();
                                                            });
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'V_PO_NO',
                                                    maxWidth: 200,
                                                    minWidth: 200,
                                                    width: 200,
                                                    labelWidth: 60,
                                                    fieldLabel: '발주번호',
                                                    name: 'search_field',
                                                    margin: '0 0 0 30',
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'V_PO_NO1',
                                                    margin: '0 0 0 30',
                                                    maxWidth: 200,
                                                    minWidth: 200,
                                                    width: 200,
                                                    labelWidth: 60,
                                                    fieldLabel: '품의번호',
                                                    name: 'search_field'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    id: 'V_PO_NO2',
                                                    margin: '0 0 0 30',
                                                    maxWidth: 230,
                                                    minWidth: 230,
                                                    width: 230,
                                                    fieldLabel: '품목코드',
                                                    labelWidth: 80,
                                                    name: 'search_field'
                                                },
                                            ]
                                        },
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'gridpanel',
                            flex: 1,
                            style: 'border: 1px solid lightgray; padding: 5px;',
                            header: false,
                            title: 'My Grid Panel',
                            id: 'myGrid',
                            store: 'MyStore',
                            tbar: [
                                   {
                                       id: 'gridAddBtn',
                                       text: '',
                                       margin: '0 3 0 0',
                                       glyph: 'xf055@FontAwesome',
                                       iconCls: 'grid-add-btn',
                                       hidden: true
                                   },
                                   {
                                       id: 'gridDelBtn',
                                       text: '',
                                       margin: '0 3 0 0',
                                       glyph: 'xf056@FontAwesome',
                                       iconCls: 'grid-del-btn',
                                       hidden: true
                                   },
                                   {
                                       xtype: 'datefield',
                                       id: 'V_GR_DT',
                                       maxWidth: 210,
                                       minWidth: 210,
                                       width: 210,
                                       fieldLabel: '입고일',
                                       labelAlign: 'left',
                                       labelWidth: 60,
                                       format: 'Y-m-d',
                                       altFormats: 'm/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j|Ymd',
                                       submitFormat: 'Y-m-d',
                                       align: 'center',
                                       listeners : {
                                           render : function(datefield) {
                                           	var nows = new Date();
                                               datefield.setValue(nows);
                                           }	
                                       },
                                       fieldStyle: 'background-color: #ffefbb'
                                   },
                                   {
                                       id: 'gridGrBtn',
                                       text: '입고등록',
                                       margin: '0 3 0 0',
                                       width: 100,
                                       cls: 'blue-btn',
                                       style: 'background-color: white; border: 0.5px solid #3367d6;'
                                   },
                                   
                                   {
                                       xtype: 'container',
                                       flex: 1
                                   },
                                   {
                                       xtype: 'button',
                                       glyph: 'xf1c3@FontAwesome',
                                       id: 'xlsxDown',
                                       cfg: {
                                           type: 'excel07',
                                           ext: 'xlsx'
                                       },
                                       iconCls: 'grid-excel-btn',
                                   }
                               ],
                            columns: [
                                {
                                    xtype: 'rownumberer',
                                    width: 40
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 150,
                                    dataIndex: 'PO_NO',
                                    text: '발주번호'
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    align: 'end',
                                    dataIndex: 'PO_SEQ',
                                    text: '발주순번',
                                    format: '0,000'
                                },
                                {
                                    xtype: 'datecolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    dataIndex: 'PO_DT',
                                    text: '발주일',
                                    format: 'Y-m-d',
                                    align: 'center',
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 170,
                                    dataIndex: 'BP_NM',
                                    text: '매입처'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 114,
                                    dataIndex: 'PO_TYPE_NM',
                                    text: '매입유형'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 114,
                                    dataIndex: 'PAY_METH_NM',
                                    text: '결제방법'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 114,
                                    dataIndex: 'ITEM_CD',
                                    text: '품목코드'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 130,
                                    dataIndex: 'ITEM_NM',
                                    text: '품목명'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 114,
                                    dataIndex: 'SPEC',
                                    text: '규격',
                                    hidden: true
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;  color: #3367d6',
                                    align: 'end',
                                    dataIndex: 'BON_QTY',
                                    text: '<span style=\'color:red\'>*</span>BON수량',
                                    format: '0,000.00',
                                    editor: {
                                    	xtype: 'numberfield',
                                    	minValue: 0
                                    },
                            		summaryType : 'sum',
                            		summaryRenderer : function(value, summaryData, dataIndex) {
                            			return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                            		}
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6 ',
                                    align: 'end',
                                    dataIndex: 'BON_WGT_UNIT',
                                    text: '단위중량',
                                    format: '0,000.00',
                                    editor: {
                                    	xtype: 'numberfield',
                                    	minValue: 0
                                    }
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                                    align: 'end',
                                    dataIndex: 'PO_QTY',
                                    text: '총중량',
                                    format: '0,000.00',
                                    editor: {
                                    	xtype: 'numberfield',
                                    	minValue: 0
                                    },
                            		summaryType : 'sum',
                            		summaryRenderer : function(value, summaryData, dataIndex) {
                            			return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                            		},
                                },
                                {
                                	xtype: 'numbercolumn',
                                	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                	text: '기입고중량',
                                	format: '0,000.00',
                                	dataIndex: 'GR_QTY',
                                	align: 'end',
                                	summaryType : 'sum',
                                	summaryRenderer : function(value, summaryData, dataIndex) {
                                		return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                                	},
                                },
                                {
                                	xtype: 'gridcolumn',
                                	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6; ',
                                	width: 150,
                                	dataIndex: 'BL_DOC_NO',
                                	text: 'B/L번호',
                                	editor: {
                                		xtype: 'textfield'
                                	}
                                },
//                                {
//                                    xtype: 'gridcolumn',
//                                    style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6; ',
//                                    width: 120,
//                                    dataIndex: 'DATA',
//                                    text: '<span style=\'color:red\'>*</span>유통이력번호',
//                                    editor: {
//                                    	xtype: 'textfield'
//                                    }
//                                },
//                                {
//                                	xtype: 'gridcolumn',
//                                	style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6; ',
//                                	width: 120,
//                                	dataIndex: 'PLANT_NO',
//                                	text: '공장번호',
//                                	editor: {
//                                		xtype: 'textfield'
//                                	}
//                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'text-align: center; font-weight: bold; color: #3367d6; font-size: 12px; ',
                                    text: '입고창고',
                                    width: 180,
                                    dataIndex: 'SL_CD',
                                    editor: {
                                		xtype: 'combobox',
                                		editable: false,
                                		displayField: 'DTL_NM',
                                		autoLoadOnValue: true,
                                		valueField: 'DTL_CD',
                                		store: Ext.create('Ext.data.Store',{
                                			autoLoad: true,
                                			storeId: 'sl_combo',
                                			proxy: {
                                		           type: 'ajax',
                                		           extraParams: {
                                		            	V_MAST_CD: 'SL_STEEL',
                                		            	V_GRID: 'Y'
                                		           },	
                                		           api: {
                                		               read: '/HSPF01/common/sql/Combobox.jsp'
                                		           },
                                		           reader: {
                                		               type: 'json',
                                		               rootProperty: 'resultList'
                                		           }
                                		       }
                                		})
                                	},
                                    renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                        if(Ext.data.StoreManager.lookup('sl_combo').findRecord('DTL_CD',value) !==null)
                                        {
                                            return Ext.data.StoreManager.lookup('sl_combo').findRecord('DTL_CD',value).get('DTL_NM');
                                        }
                                        return value;
                                    },
                                },
                                {
                                	xtype: 'datecolumn',
                                	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                	text: '입고일자',
                                	dataIndex: 'MVMT_DT',
                                	enableTextSelection: true,
                                	format: 'Y-m-d'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    width: 114,
                                    dataIndex: 'CUR',
                                    text: '화폐단위',
                                    hidden: true
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                    align: 'end',
                                    dataIndex: 'XCH_RT',
                                    text: '환율',
                                    hidden: true
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                                    align: 'end',
                                    dataIndex: 'PO_AMT',
                                    text: '외화금액',
                                    format: '0,000.000000',
                                    editor: {
                                    	xtype: 'numberfield'
                                    },
                                    hidden: true
                                },
                                {
                                    xtype: 'numbercolumn',
                                    style: 'font-size: 12px; text-align: center; font-weight: bold; color: #3367d6',
                                    align: 'end',
                                    dataIndex: 'PO_LOC_AMT',
                                    text: '자국금액',
                                    format: '0,000',
                                    width: 130,
                                    editor: {
                                    	xtype: 'numberfield'
                                    },
                                },
                                {
                                	xtype: 'gridcolumn',
                                	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                	width: 114,
                                	dataIndex: 'GR_YN',
                                	text: 'GR_YN',
                                	hidden: true
                                },
                            ],
                            viewConfig: {
                            	enableTextSelection: true,
                            	getRowClass: function(record, index) {
                                    var GR_YN = record.get('GR_YN'); //입고유무 
                                    
                                    if(GR_YN == 'Y') {
                                    	return 'bg-green';
                                    }
                                },
                            },
                            selModel: {
                                selType: 'checkboxmodel',
//                                checkOnly: true,
                                listeners: {
                                	select: function(rowmodel, record, index, eOpts) {
                                		record.set('V_TYPE', 'V');
                                	},
                                	deselect: function(rowmodel, record, index, eOpts) {
                                		record.set('V_TYPE', '');
                                	}
                                }
                            },
                            plugins: [
                                {
                                    ptype: 'gridexporter'
                                },
                                {
                                    ptype: 'cellediting',
                                    listeners: {
                                    	edit: function(editor, context, eOpts) {
                                    		var selModel = Ext.getCmp('myGrid').getSelectionModel();
                            				
                                    		var BON_QTY = Number(context.record.data.BON_QTY); 
                                    		var BON_WGT_UNIT = Number(context.record.data.BON_WGT_UNIT); 
                                    		var QTY = Number(context.record.data.PO_QTY);
                                    		
                                    		if(context.column.dataIndex == 'BON_QTY') {
                                    			if(BON_QTY > 0) {
                                    				context.record.set('BON_WGT_UNIT', Math.round(QTY / BON_QTY*100)/100 );
                                    			}
                                    		}
                                    		if(context.column.dataIndex == 'PO_QTY') {
                                    			if(BON_QTY > 0) {
                                    				context.record.set('BON_WGT_UNIT', Math.round(QTY / BON_QTY*100)/100 );
                                    			}
                                    		}
                                    		
                                    	}
                                    }
                                }
                            ],
                            features : [ {
                        		ftype : 'summary',
                        		dock: 'bottom'
                        	} ],
                        }
                    ]
                },
                {
                    xtype: 'splitter',
                    collapseTarget: 'prev'
                },
                {
                    xtype: 'container',
                    flex: 1,
                    layout: {
                        type: 'vbox',
                        align: 'stretch'
                    },
                    items: [
                        {
                            xtype: 'mysearchform',
                            margin: '-5 0 0 0',
                            padding: '',
                            bodyPadding: '0 10 0 10',
                            margins: ''
                        },
                        {
                        	xtype: 'container',
                        	layout: {
                                type: 'hbox',
                                align: 'stretch'
                            },
                            flex: 1,
                            items:[

                    			{
                                    xtype: 'gridpanel',
                                    flex: 1,
                                    style: 'border: 1px solid lightgray; padding: 5px;',
                                    bodyBorder: false,
                                    header: false,
                                    title: 'My Grid Panel',
                                    store: 'MyStore1',
                                    id: 'myGrid1',
                                    tbar: [
                                           {
                                               id: 'gridAddBtn1',
                                               text: '',
                                               margin: '0 3 0 0',
                                               glyph: 'xf055@FontAwesome',
                                               iconCls: 'grid-add-btn',
                                               disabled: true
                                           },
                                           {
                                               id: 'gridDelBtn1',
                                               text: '',
                                               margin: '0 3 0 0',
                                               glyph: 'xf056@FontAwesome',
                                               iconCls: 'grid-del-btn',
//                                                       disabled: true
                                           },
//                                                   {
//                                                      	id: 'gridSaveBtn',
//                                                      	xtype: 'button',
//                                                      	glyph: 'xf0c7@FontAwesome',
//                                                      	iconCls: 'grid-save-btn',
//                                                      	margin: '0 3 0 0'
//                                                  },
                                           {
                                               xtype: 'container',
                                               flex: 1
                                           },
                                           {
                                               xtype: 'button',
                                               glyph: 'xf1c3@FontAwesome',
                                               id: 'xlsxDown1',
                                               cfg: {
                                                   type: 'excel07',
                                                   ext: 'xlsx'
                                               },
                                               iconCls: 'grid-excel-btn',
                                           }
                                       ],
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 40
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 170,
                                            dataIndex: 'MVMT_NO',
                                            text: '입고번호'
                                        },
                                        {
                                        	xtype: 'datecolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	width: 100,
                                        	dataIndex: 'MVMT_DT',
                                        	text: '입고일자',
                                        	align: 'center',
                                        	format: 'Y-m-d'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 150,
                                            dataIndex: 'M_BP_NM',
                                            text: '매입처'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 100,
                                            dataIndex: 'IV_TYPE_NM',
                                            text: '매입유형'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 150,
                                            dataIndex: 'PAY_METH_NM',
                                            text: '결제방법'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 114,
                                            dataIndex: 'ITEM_CD',
                                            text: '품목코드'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 130,
                                            dataIndex: 'ITEM_NM',
                                            text: '품목명'
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            align: 'end',
                                            dataIndex: 'BON_QTY',
                                            text: 'BON수량',
                                            format: '0,000.00',
                                    		summaryType : 'sum',
                                    		summaryRenderer : function(value, summaryData, dataIndex) {
                                    			return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                                    		}
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            align: 'end',
                                            dataIndex: 'BON_WGT_UNIT',
                                            text: '단위중량',
                                            format: '0,000.00'
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            align: 'end',
                                            dataIndex: 'QTY',
                                            text: '총중량',
                                            format: '0,000.00',
                                    		summaryType : 'sum',
                                    		summaryRenderer : function(value, summaryData, dataIndex) {
                                    			return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                                    		}
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 114,
                                            dataIndex: 'CUR',
                                            text: '화폐단위',
                                            hidden: true
                                        },
                                        {
                                        	xtype: 'numbercolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	align: 'end',
                                        	dataIndex: 'DOC_AMT',
                                        	text: '외화금액',
                                    		summaryType : 'sum',
                                    		summaryRenderer : function(value, summaryData, dataIndex) {
                                    			return "<font color='green'>" + Ext.util.Format.number(value, '0,000.00') + "<font>";
                                    		},
                                    		hidden: true
                                        },
                                        {
                                        	xtype: 'numbercolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	align: 'end',
                                        	dataIndex: 'PRICE',
                                        	text: '단가',
                                        	width: 130,
                                        	format: '0,000.00000',
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            align: 'end',
                                            dataIndex: 'LOC_AMT',
                                            text: '자국금액',
                                            width: 130,
                                            format: '0,000',
                                    		summaryType : 'sum',
                                    		summaryRenderer : function(value, summaryData, dataIndex) {
                                    			return "<font color='green'>" + Ext.util.Format.number(value, '0,000') + "<font>";
                                    		}
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                            width: 114,
                                            dataIndex: 'SL_NM',
                                            text: '창고'
                                        },
                                    ],
                                    selModel: {
                                        selType: 'checkboxmodel',
                                        listeners: {
                                        	select: function(rowmodel, record, index, eOpts) {
                                    			record.set('V_TYPE', 'V');
                                            },
                                            deselect: function(rowmodel, record, index, eOpts) {
                                    			record.set('V_TYPE', '');
                                            }
                                        }
                                    },
                                    viewConfig: {
                                    	enableTextSelection: true,
                                    },
                                    plugins: [
                                        {
                                            ptype: 'gridexporter'
                                        },
                                        {
                                            ptype: 'cellediting'
                                        }
                                    ],
                                	features : [ {
                                		ftype : 'summary'
                                	} ]
                                },
                                {
                                    xtype: 'gridpanel',
                                    flex: 1,
                                    style: 'border: 1px solid lightgray; padding: 5px;',
                                    bodyBorder: false,
                                    header: false,
                                    title: 'My Grid Panel',
                                    store: 'MyStore2',
                                    id: 'myGrid2',
                                    tbar: [
                                           {
                                               id: 'gridAddBtn2',
                                               text: '',
                                               margin: '0 3 0 0',
                                               glyph: 'xf055@FontAwesome',
                                               iconCls: 'grid-add-btn',
//                                               disabled: true
                                           },
                                           {
                                               id: 'gridDelBtn2',
                                               text: '',
                                               margin: '0 3 0 0',
                                               glyph: 'xf056@FontAwesome',
                                               iconCls: 'grid-del-btn',
//                                               disabled: true
                                           },
                                           {
                                              	id: 'gridSaveBtn2',
                                              	xtype: 'button',
                                              	glyph: 'xf0c7@FontAwesome',
                                              	iconCls: 'grid-save-btn',
                                              	margin: '0 3 0 0'
                                          },
                                           {
                                               xtype: 'container',
                                               flex: 1
                                           },
                                           {
                                               xtype: 'button',
                                               glyph: 'xf1c3@FontAwesome',
                                               id: 'xlsxDown2',
                                               cfg: {
                                                   type: 'excel07',
                                                   ext: 'xlsx'
                                               },
                                               iconCls: 'grid-excel-btn',
                                           }
                                       ],
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 40
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'text-align: center; font-weight: bold;  ',
                                            sortable: true,
                                            dataIndex:'ST_TYPE',
                                            enableTextSelection: true,
                                            text: '강종',
                                            width: 100
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                                            sortable: true,
                                            dataIndex: 'ST_TYPE_NM',
                                            enableTextSelection: true,
                                            text: '강종명',
                                            width: 140,
                                            editor: {
                                        		xtype: 'combobox',
                                        		displayField: 'DTL_NM',
                                        		autoLoadOnValue: false,
                                        		valueField: 'DTL_NM',
                                        		editable: false,
                                        		store:'StStore',
                                              	listConfig: {
                                                    itemTpl: [
                                                        '<div>{DTL_NM} ({DTL_CD})</div>'
                                                    ],
                                                }
                                        	},
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                            sortable: true,
                                            dataIndex: 'SPEC1',
                                            enableTextSelection: true,
                                            text: '스펙1',
                                            width: 100,
                                            editor: {
                                            	xtype: 'textfield'
                                            }
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                        	sortable: true,
                                        	dataIndex: 'SPEC2',
                                        	enableTextSelection: true,
                                        	text: '스펙2',
                                        	width: 100,
                                            editor: {
                                            	xtype: 'textfield'
                                            }
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                        	sortable: true,
                                        	dataIndex: 'SPEC3',
                                        	enableTextSelection: true,
                                        	text: '스펙3',
                                        	width: 100,
                                            editor: {
                                            	xtype: 'textfield'
                                            }
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                        	sortable: true,
                                        	dataIndex: 'LENGTH',
                                        	enableTextSelection: true,
                                        	text: '스펙4',
                                        	width: 100,
                                            editor: {
                                            	xtype: 'textfield'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            style: 'text-align: center; font-weight: bold;',
                                            sortable: true,
                                            dataIndex: 'UNIT',
                                            enableTextSelection: true,
                                            text: '단위',
                                            width: 80,
                                            hidden: true
                                        },
                                        {
                                        	xtype: 'numbercolumn',
                                        	style: 'text-align: center; font-weight: bold; color: #3367d6',
                                        	sortable: true,
                                        	dataIndex:'PRICE',
                                        	enableTextSelection: true,
                                        	format: '0,000',
                                        	width: 100,
                                        	align: 'right',
                                        	text: '단가',
                                        	 editor: {
                                             	xtype: 'numberfield',
                                             	decimalPrecision: 0,
                                             	align: 'right',
                                             	minValue: 0
                                             },
                                        },
                                        {
                                        	xtype: 'numbercolumn',
                                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                                            sortable: true,
                                            dataIndex:'BON_QTY',
                                            enableTextSelection: true,
                                            format: '0,000.00',
                                            width: 100,
                                            align: 'right',
                                            text: 'BON수량',
                                            editor: {
                                            	xtype: 'numberfield',
                                            	decimalPrecision: 2,
                                            	align: 'right',
                                            	minValue: 0
                                            },
                                            summaryType: 'sum',
                                            summaryRenderer: function (value, summaryData, dataIndex) {
                                	            return "<font color='green'>"+Ext.util.Format.number(value, '0,000.00')+"<font>"; 
                                	        },
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                            text: '단위중량',
                                            format: '0,000.00',
                                            align: 'right', 
                                            dataIndex: 'BON_WGT_UNIT',
                                            summaryType: 'sum',
                                            summaryRenderer: function (value, summaryData, dataIndex) {
                                	            return "<font color='green'>"+Ext.util.Format.number(value, '0,000.00')+"<font>"; 
                                	        },
                                            editor: {
                                            	xtype: 'numberfield',
                                            	decimalPrecision: 2,
                                            	align: 'right',
                                            	minValue: 0
                                            },
                                            width: 130
                                        },
                                        {
                                            xtype: 'numbercolumn',
                                            style: 'text-align: center; font-weight: bold;  color: #3367d6',
                                            text: '중량',
                                            format: '0,000.00',
                                            align: 'right', 
                                            dataIndex: 'QTY',
                                            summaryType: 'sum',
                                            summaryRenderer: function (value, summaryData, dataIndex) {
                                	            return "<font color='green'>"+Ext.util.Format.number(value, '0,000.00')+"<font>"; 
                                	        },
                                            editor: {
                                            	xtype: 'numberfield',
                                            	decimalPrecision: 2,
                                            	align: 'right',
                                            	minValue: 0
                                            },
                                            width: 130
                                        },
                                        {
                                        	xtype: 'numbercolumn',
                                        	style: 'text-align: center; font-weight: bold;  ',
                                        	text:'자국금액',
                                        	dataIndex:'LOC_AMT',
                                        	align: 'right',
                                        	format: '0,000',
                                        	summaryType: 'sum',
                                        	summaryRenderer: function (value, summaryData, dataIndex) {
                                        		return "<font color='green'>"+Ext.util.Format.number(value, '0,000')+"<font>"; 
                                        	},
                                        	width: 130,
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	width: 114,
                                        	dataIndex: 'MVMT_NO',
                                        	text: 'MVMT_NO',
                                        	hidden: true
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	width: 114,
                                        	dataIndex: 'MVMT_SEQ',
                                        	text: 'MVMT_SEQ',
                                        	hidden: true
                                        },
                                        {
                                        	xtype: 'gridcolumn',
                                        	style: 'font-size: 12px; text-align: center; font-weight: bold;',
                                        	width: 114,
                                        	dataIndex: 'ITEM_GROUP_CD',
                                        	text: 'ITEM_GROUP_CD',
                                        	hidden: true
                                        },
                                    ],
                                    selModel: {
                                        selType: 'checkboxmodel',
                                        listeners: {
                                        	select: function(rowmodel, record, index, eOpts) {
                                    			record.set('V_TYPE', 'V');
                                            },
                                            deselect: function(rowmodel, record, index, eOpts) {
                                    			record.set('V_TYPE', '');
                                            }
                                        }
                                    },
                                    viewConfig: {
                                    	enableTextSelection: true,
                                    },
                                    plugins: [
                                        {
                                            ptype: 'gridexporter'
                                        },
                                        {
                                            ptype: 'clipboard'
                                        },
                                        {
                                            ptype: 'cellediting',
                                            clicksToEdit: 2,
                                            listeners: {
                                            	beforeedit: function(editor, context, eOpts) {
                                            		if(Ext.getCmp('myGrid1').getSelectionModel().getSelection().length > 0 &&
                                            				context.field == 'ST_TYPE_NM') {
                                            			var StStore  = Ext.getStore('StStore');
                                                    	StStore.load(
                                        					{   
                                        						params: 
                                        						{
                                        							V_MAST_CD : 'ST',
                                        							V_PARAM1 :  Ext.getCmp('myGrid1').getSelectionModel().getSelection()[0].get('ITEM_CD'),
                                        							V_GRID: 'Y' 
                                        						},
                                        					});
                                            		}
                                            		
                                            	},
                                            	
                                            	edit: function(editor, context, eOpts) {
                                            		var QTY = context.record.get('QTY');
                                            		var BON_QTY = context.record.get('BON_QTY');
                                            		var BON_WGT_UNIT = context.record.get('BON_WGT_UNIT');
                                        			var PRICE = context.record.get('PRICE');
                                        			var LOC_AMT = context.record.get('LOC_AMT');
                                        			
                                            		
                                            		if(context.field == 'BON_QTY' || context.field == 'BON_WGT_UNIT') {
                                            			context.record.set('QTY', BON_QTY * BON_WGT_UNIT);
                                            			context.record.set('LOC_AMT', (PRICE * BON_QTY * BON_WGT_UNIT).toFixed(0));
                                            		}
                                            		
                                            		if(context.field == 'QTY' || context.field == 'PRICE' ) {
                                            			context.record.set('LOC_AMT', (PRICE * QTY).toFixed(0));
                                            		}
                                            		
                                            		if(context.field == 'SPEC1' || context.field == 'SPEC2' || context.field == 'SPEC3') {
                                            			if(context.value.length > 4){
                                            				Ext.Msg.alert('확인', '4자리 수를 초과할 수 없습니다.');
                                            				context.record.set(context.field, context.originalValue);
                                            			}
                                            		}
                                            		
                                            		if(context.field == 'LENGTH') {
                                            			if(context.value.length > 2){
                                            				Ext.Msg.alert('확인', '2자리 수를 초과할 수 없습니다.');
                                            				context.record.set(context.field, context.originalValue);
                                            			}
                                            		}
                                            	}
                                            	
                                            }
                                        }
                                    ],
                                    features : [ {
                                		ftype : 'summary',
                                		dock: 'bottom'
                                	} ],
                                },
                                
                            ]
                        },
                        
                    ]
                }
            ]
        }
    ]

});