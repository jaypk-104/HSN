/*
 * File: app/controller/MyGridController.js
 *
 * This file was generated by Sencha Architect version 4.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('M_TO_DN_PR_TOT_HSPF.controller.MyGridController', {
	extend : 'Ext.app.Controller',

	control : {
		"#printBtn" : {
			click : 'printBtnClick'
		},
		"#xlsxDown" : {
			click : 'xlsxDownClick'
		},
	},

	printBtnClick : function(button, e, eOpts) {
    	var url = '';
    	
    	if(parent.Ext.getCmp('MAIN_SERVER_YN').getValue() == 'Y'){
    		var url_QTY = 'http://123.142.124.170:8080/aireport/on_server/S_DN_BILL_RECEIPT_TOT_QTY.jsp?';
	    	var url_PRC = 'http://123.142.124.170:8080/aireport/on_server/S_DN_BILL_RECEIPT_TOT_PRC.jsp?';  	
		} else{
	    	var url_QTY = 'http://123.142.124.170:8080/aireport/on_server/S_DN_BILL_RECEIPT_TOT_QTY_TEST.jsp?';
	    	var url_PRC = 'http://123.142.124.170:8080/aireport/on_server/S_DN_BILL_RECEIPT_TOT_PRC_TEST.jsp?';  	
		}
    	
    	if(Ext.getCmp('V_S_BP_CD').getValue() != '') {
    		var S_BP_CD = Ext.getCmp('V_S_BP_CD').getValue();
    		var M_BP_CD = Ext.getCmp('V_M_BP_CD').getValue();
    		var DN_DTFR = Ext.getCmp('V_DN_DT_FR').lastValue;
    		var DN_DTTO = Ext.getCmp('V_DN_DT_TO').lastValue;
    		var DN_NO = Ext.getCmp('V_DN_NO').getValue();
    		var SALE_TYPE = Ext.getCmp('V_SALE_TYPE').getValue();
    		if(SALE_TYPE == 'T') SALE_TYPE = '';
    		
    		var params = 'BP_CD=' + S_BP_CD + '&DN_DTFR=' + DN_DTFR + '&DN_DTTO=' + DN_DTTO + '&DN_NO=' + DN_NO + '&SALE_TYPE=' + SALE_TYPE+ '&M_BP_CD=' + M_BP_CD;

    		if(Ext.getCmp('V_PRINT_TYPE').getValue() == 'QTY') {
    			url = url_QTY + params
    		} else {
    			url = url_PRC + params;
    		}
    		
    		Ext.Msg.confirm('확인', '거래명세표를 출력하시겠습니까?', function(button) {
        		if (button == 'yes') {
					var myWin = new Ext.Window({
						title : '거래명세표',
						html : '<iframe name="xxx" border =0 src="'+url+'" width="100%" height="100%"></iframe>',
						width : 1000,
						height : 768,
						modal : true
					});
					myWin.show();
					myWin.setSize(Ext.getBody().getViewSize());
					myWin.setPagePosition(0, 0);
        		}
        	})
    	} else {
    		Ext.Msg.alert('확인', '거래처코드를 입력하세요.');
    	}
    },
	
	xlsxDownClick : function(button, e, eOpts) {
		var currentDate = Ext.util.Format.date(new Date(), 'Y-m-d His');
		var grid = Ext.getCmp('myGrid');
		grid.saveDocumentAs({
			type : 'xlsx',
			title : '거래명세표출력', // 엑셀내타이틀
			fileName : currentDate + '.xlsx' // 엑셀파일이름
		});
	},

});
