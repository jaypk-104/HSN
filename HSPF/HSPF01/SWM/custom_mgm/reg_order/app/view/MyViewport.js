/*
 * File: app/view/MyViewport.js
 *
 * This file was generated by Sencha Architect version 3.5.1.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('rawpurchase.view.MyViewport', {
	extend: 'Ext.container.Viewport',
	alias: 'widget.myviewport',

	requires: ['rawpurchase.view.MyViewportViewModel1', 'Ext.form.Panel', 'Ext.button.Button', 'Ext.form.field.Text', 'Ext.form.field.Hidden', 'Ext.grid.Panel', 'Ext.grid.column.RowNumberer', 'Ext.grid.column.Check', 'Ext.form.field.Checkbox', 'Ext.view.Table', 'Ext.grid.plugin.CellEditing'],

	viewModel: {
		type: 'myviewport'
	},
	id: 'MyViewport',
	layout: 'card',
	defaultListenerScope: true,

	items: [{
		xtype: 'form',
		modal: true,
		layout: 'border',
		// bodyPadding: 10,
		bodyStyle: 'background-color: #FFFFFF !important',
		header: true,
		title: '▶주문등록',
		items: [{
			xtype: 'panel',
			region: 'center',
			id: 'mainForm',
			layout: 'border',
			bodyPadding: 10,
			bodyStyle: 'background-color: #FFFFFF !important',
			header: false,
			// title: '▶주문등록',
			titleAlign: 'left',
			items: [{
				xtype: 'container',
				region: 'north',
				height: 34,
				margin: '0 0 3 0',
				items: [{
					xtype: 'button',
					id: 'selectBtn',
					maxWidth: 100,
					minWidth: 100,
					text: '조회',
					height: 34,
					glyph: 'xf002@FontAwesome',
					margin: '0 3 0 0'
				}, {
					xtype: 'button',
					id: 'addBtn',
					maxWidth: 100,
					minWidth: 100,
					text: '주문등록',
					height: 34,
//					icon: '../../../images/btn/refBtn.png',
					margin: '0 3 0 0'
				}]
			}, {
				xtype: 'container',
				region: 'north',
				height: 120,
				style: 'background-color: #EDEFF5 !important',
				layout: {
					type: 'hbox',
					align: 'stretch'
				},
				items: [{
					xtype: 'container',
					flex: 0.4,
					dock: 'left',
					items: [{
						xtype: 'textfield',
						id: 'txtItemCd',
						fieldLabel: '품목코드',
						labelAlign: 'right',
						width: 400,
						minWidth: 400,
						maxWidth: 400,
						margin: '5 0 5 0',
						labelStyle: 'background-color: #EDEFF5 !important; font-size:12px;',
						fieldStyle: 'font-family:gulim,times,courier,arial;font-size:12px;'
					}, {
						xtype: 'textfield',
						id: 'txtItemNm',
						maxWidth: 400,
						minWidth: 400,
						margin: '0 0 5 0',
						fieldLabel: '품목명',
						labelAlign: 'right',
						labelStyle: 'background-color: #EDEFF5 !important;font-size:12px;',
						fieldStyle: 'font-family:times,courier,arial;font-size:12px;'
					}, {
						xtype: 'textfield',
						id: 'txtBpItemCd',
						maxWidth: 400,
						minWidth: 400,
						margin: '0 0 5 0',
						fieldLabel: '주문처품목코드',
						labelAlign: 'right',
						labelStyle: 'background-color: #EDEFF5 !important;font-size:12px;',
						fieldStyle: 'font-family:times,courier,arial;font-size:12px;'
					}]
				}, {
					xtype: 'container',
					flex: 0.6,
					items: [{
						xtype: 'hiddenfield',
						id: 'gridCol',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'itemPopCheck',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'gridCd1',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'gridCd2',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'gBpCd',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'gUserId',
						fieldLabel: 'Label'
					}, {
						xtype: 'hiddenfield',
						id: 'g_s_req_no',
						fieldLabel: 'Label'
					}, {
						xtype: 'textfield',
						id: 'txtSpec',
						fieldLabel: '규격',
						fieldStyle: 'font-family:times,courier,arial;font-size:12px;',
						labelStyle: 'background-color: #EDEFF5 !important;font-size:12px;',
						labelAlign: 'right',
						margin: '5 0 5 0',
						width: 400,
						minWidth: 400,
						maxWidth: 400
					}, {
						xtype: 'textfield',
						id: 'txtMaker',
						fieldLabel: 'Maker',
						labelAlign: 'right',
						margin: '0 0 5 0',
						labelStyle: 'background-color: #EDEFF5 !important; font-size:12px;',
						fieldStyle: 'font-family:times,courier,arial;font-size:12px;',
						width: 400,
						minWidth: 400,
						maxWidth: 400
					}, {
						xtype: 'textfield',
						id: 'txtBpItemNm',
						fieldLabel: '주문처품목명',
						labelAlign: 'right',
						margin: '0 0 5 0',
						labelStyle: 'background-color: #EDEFF5 !important; font-size:12px;',
						fieldStyle: 'font-family:times,courier,arial;font-size:12px;',
						width: 400,
						minWidth: 400,
						maxWidth: 400
					}]
				}]
			}, {
				xtype: 'gridpanel',
				multiSelect: false,
				region: 'center',
				id: 'grid1',
				bodyBorder: true,
				constrainHeader: true,
				header: false,
				title: '   ',
				store: 'RawPurStore',
				columns: [{
					xtype: 'rownumberer'
				}, {
					xtype: 'checkcolumn',
					id: 'checks',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 63,
					dataIndex: 'checks',
					text: '선택'
//					editor: {
//						xtype: 'checkboxfield'
//					}
				}, {
					xtype: 'gridcolumn',
					id: 'item_cd',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 129,
					dataIndex: 'item_cd',
					text: '품목코드'
				}, {
					xtype: 'gridcolumn',
					id: 'item_nm',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 146,
					dataIndex: 'item_nm',
					text: '품목명'
				}, {
					xtype: 'gridcolumn',
					id: 'bp_item_cd',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 144,
					dataIndex: 'bp_item_cd',
					text: '주문처품목코드'
				}, {
					xtype: 'gridcolumn',
					id: 'bp_item_nm',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 139,
					dataIndex: 'bp_item_nm',
					text: '주문처품목명'
				}, {
					xtype: 'gridcolumn',
					id: 'spec',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 139,
					dataIndex: 'spec',
					text: '규격'
				}, {
					xtype: 'gridcolumn',
					id: 'maker',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 139,
					dataIndex: 'maker',
					text: 'Maker'
				}, {
					xtype: 'gridcolumn',
					id: 'unit',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 107,
					dataIndex: 'unit',
					text: '단위'
				}, {
					xtype: 'gridcolumn',
					renderer: function(value, metaData, record, rowIndex, colIndex, store, view){
						return Ext.util.Format.number(value, '0,000');
					},
					id: 'so_qty',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 123,
					align: 'right',
					dataIndex: 'so_qty',
					text: '수량',
					editor: {
						xtype: 'textfield'
					}
				}, {
					xtype: 'gridcolumn',
					renderer: function(value, metaData, record, rowIndex, colIndex, store, view){
						return Ext.util.Format.number(value, '0,000');
					},
					id: 'so_prc',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 123,
					align: 'right',
					dataIndex: 'so_prc',
					text: '품목단가'
				}, {
					xtype: 'gridcolumn',
					renderer: function(value, metaData, record, rowIndex, colIndex, store, view){
						return Ext.util.Format.number(value, '0,000');
					},
					id: 'so_amt',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 123,
					align: 'right',
					dataIndex: 'so_amt',
					text: '금액'
				}, {
					xtype: 'gridcolumn',
					id: 'net_usr_nm1',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 167,
					dataIndex: 'net_usr_id',
					text: '네트웍스 담당자'
				}, {
					xtype: 'gridcolumn',
					id: 'net_usr_nm',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 167,
					dataIndex: 'net_usr_nm',
					text: '네트웍스 담당자명'
				}, {
					xtype: 'gridcolumn',
					id: 'net_usr_mail',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 167,
					dataIndex: 'net_usr_mail',
					text: '네트웍스 E-MAIL'
				}, {
					xtype: 'gridcolumn',
					id: 'net_usr_tel',
					style: ' font-size:12px;font-family:times,courier,arial;font-weight:bold;text-align:center; background-color: #F8F8F8 !important',
					width: 167,
					dataIndex: 'net_usr_tel',
					text: '담당자 전화번호'
				}],
				viewConfig: {
					height: 348,
					enableTextSelection: true
				},
				plugins: [{
					ptype: 'cellediting',
					clicksToEdit: 1,
					listeners: {
						edit: 'onCellEditingEdit'
					}
				}]
			}]
		}]
	}],

	onCellEditingEdit: function(editor, context, eOpts){
		// alert(context.colIdx);

		if (context.colIdx === 9) {
			var so_qtys = context.record.get('so_qty');
			var so_prcs = context.record.get('so_prc');
			var so_amts = so_qtys * so_prcs;
			context.record.set('so_amt', so_amts);

		}
	}

});