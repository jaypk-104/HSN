/*
 * File: app/controller/MyWindowController.js
 *
 * This file was generated by Sencha Architect version 4.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('CHARGE_OUT_DISTR_SELECT_SAMHYUN.controller.MyWindowController', {
    extend: 'Ext.app.Controller',

    stores: [
        'MyStore'
    ],

    control: {
        "#W_HSPFSendBtn": {
            click: 'W_HSPFSendBtnClick'
        },
        "#W_printBtn": {
            click: 'W_printBtnClick'
        }
    },

    W_HSPFSendBtnClick: function(button, e, eOpts) {
        var store = this.getMyStoreStore();
        Ext.Msg.confirm('확인','플랫폼 전송 하시겠습니까?', function(button){
            if(button == 'yes') {
                Ext.Ajax.request({
                    url:'sql/charge_out_distr_select.jsp',
                    method: 'post',
                    params: {
                        V_TYPE: 'W_SEND',
                        V_M_CHARGE_NO: Ext.getCmp('W_M_CHARGE_NO').getValue(),
                        V_USR_ID : parent.Ext.getCmp('GUSER_ID').getValue(),

                    },
                    callback : function(records,operations,success){
                        Ext.getCmp('S_ERP_LC_NO').setValue(Ext.getCmp('W_LC_NO').getValue());
                        Ext.getCmp('S_ERP_BL_NO').setValue(Ext.getCmp('W_BL_NO').getValue());
                        Ext.getCmp('S_ERP_BL_SEQ').setValue(Ext.getCmp('W_BL_SEQ').getValue());
                        Ext.getCmp('W_HSPFSendBtn').setDisabled(true);
                        store.reload();
                    },
                    success : function(response) {

                    },
                    scope: this
                });
            }
        });
    },

    W_printBtnClick: function(button, e, eOpts) {
        var V_M_CHARGE_NO = Ext.getCmp('W_M_CHARGE_NO').getValue();

        var myWin = new Ext.Window({
                title : '지불명세서',
                html : '<iframe name="xxx" border =0 src="http://123.142.124.170:8080/aireport/on_server/SAMHYUN_BILL.jsp?V_M_CHARGE_NO='+V_M_CHARGE_NO+'" width="100%" height="100%"></iframe>',
                width : 1000,
                height : 768,
                modal : true
            });
            myWin.show();

            var size = Ext.getBody().getViewSize();
            size.height = size.height * (4/5);
            size.width = size.width * (4/5);
            myWin.setSize(size);
            myWin.setPagePosition(0, 0);
    }

});
