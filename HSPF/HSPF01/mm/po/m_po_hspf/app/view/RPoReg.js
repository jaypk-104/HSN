/*
 * File: app/view/RPoReg.js
 *
 * This file was generated by Sencha Architect version 4.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('M_PO_HSPF.view.RPoReg', {
    extend: 'Ext.container.Container',
    alias: 'widget.rporeg',

    requires: [
        'M_PO_HSPF.view.RPoRegViewModel',
        'M_PO_HSPF.view.RPoRegViewController',
        'Ext.form.FieldSet',
        'Ext.form.FieldContainer',
        'Ext.form.field.Date',
        'Ext.form.field.ComboBox',
        'Ext.grid.Panel',
        'Ext.view.Table',
        'Ext.grid.column.RowNumberer',
        'Ext.form.field.Number',
        'Ext.grid.column.Number',
        'Ext.grid.column.Date',
        'Ext.selection.CheckboxModel',
        'Ext.grid.plugin.Exporter',
        'Ext.grid.plugin.RowEditing'
    ],

    controller: 'rporeg',
    viewModel: {
        type: 'rporeg'
    },
    flex: 1,
    padding: '0 10 0 10',

    layout: {
        type: 'vbox',
        align: 'stretch'
    },
    items: [
        {
            xtype: 'container',
            items: [
                {
                    xtype: 'fieldset',
                    cls: 'gridfieldset',
                    height: 180,
                    maxHeight: 180,
                    minHeight: 180,
                    title: '발주등록',
                    layout: {
                        type: 'vbox',
                        align: 'stretch',
                        pack: 'center',
                        padding: 10
                    },
                    items: [
                        {
                            xtype: 'fieldcontainer',
                            layout: {
                                type: 'hbox',
                                align: 'stretch'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    flex: 1,
                                    id: 'V_PO_NO',
                                    maxWidth: 250,
                                    minWidth: 250,
                                    width: 250,
                                    fieldLabel: '발주번호',
                                    labelWidth: 80,
                                    name: 'search_field',
                                    emptyText: 'Double Click',
                                    editable: false,
                                    listeners: {
                                        afterrender: function(c) {
                                        	c.getEl().on('dblclick', function() {
                                        		var popup = Ext.create("Popup.view.WinPoPop");
                                                
                                                var width = Ext.getBody().getViewSize().width - 200;
                                                var height = Ext.getBody().getViewSize().height - 200;
                                                popup.setSize(width, height);
                                                popup.center();
                                                popup.show();
                                                
                                                var store = Ext.getStore('WinPoPopStore');
                                        		store.removeAll();
                                            });
                                        }
                                    }
                                },
                                {
                                    xtype: 'combobox',
                                    flex: 1,
                                    id: 'V_PO_TYPE',
                                    margin: '0 0 0 30',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    fieldLabel: '발주유형',
                                    labelWidth: 80,
                                    displayField: 'DTL_NM',
                                    valueField: 'DTL_CD',
                                    editable: false,
                                    fieldStyle: 'background-color: #F8E0EC',
                                    store: Ext.create('Ext.data.Store',{
                                  		autoLoad: true,
                                  		storeId: 'store1',
                                  		proxy: {
                                              type: 'ajax',
                                              extraParams: {
                                               	V_MAST_CD: 'MA02',
                                               	V_GRID: 'Y'
                                              },	
                                              api: {
                                                  read: '/HSPF01/common/sql/Combobox.jsp'
                                              },
                                              reader: {
                                                  type: 'json',
                                                  rootProperty: 'resultList'
                                              }
                                          }
                                  	}),
                                  	listConfig: {
                                        itemTpl: [
                                            '<div>{DTL_NM} ({DTL_CD})</div>'
                                        ]
                                    }
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_PO_TYPE_N',
                                    margin: '0 0 0 30',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    fieldLabel: '발주유형',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                    xtype: 'datefield',
                                    id: 'V_PO_DT',
                                    margin: '0 0 0 30',
                                    maxWidth: 250,
                                    minWidth: 250,
                                    width: 250,
                                    fieldLabel: '발주일자',
                                    labelWidth: 80,
                                    name: 'search_field',
                                    format: 'Y-m-d',
                                    listeners : {
                                        render : function(datefield) {
                                        	var nows = new Date();
                                            datefield.setValue(nows);
                                        }	
                                    },
                                    fieldStyle: 'background-color: #F8E0EC'
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_PO_DT_N',
                                    margin: '0 0 0 30',
                                    maxWidth: 250,
                                    minWidth: 250,
                                    width: 250,
                                    fieldLabel: '발주일자',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                    xtype: 'numberfield',
                                    flex: 1,
                                    id: 'V_RATE',
                                    margin: '0 0 0 80',
                                    maxWidth: 220,
                                    minWidth: 220,
                                    width: 220,
                                    fieldLabel: '환율',
                                    labelWidth: 80,
                                    format: '0,000.0000',
                                    value: 1,
                                    fieldStyle: 'background-color: #F8E0EC',
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_RATE_N',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    margin: '0 0 0 80',
                                    fieldLabel: '환율',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                            ]
                        },
                        {
                            xtype: 'fieldcontainer',
                            layout: {
                                type: 'hbox',
                                align: 'stretch'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    flex: 1,
                                    id: 'V_M_BP_CD2',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    fieldLabel: '공급사CD',
                                    labelWidth: 80,
                                    hidden: true
                                },
                                {
                                	xtype: 'textfield',
                                	flex: 1,
                                	id: 'V_M_BP_NM2',
                                	maxWidth: 250,
                                	minWidth: 250,
                                	width: 250,
                                	fieldLabel: '공급사',
                                    fieldStyle: 'background-color: #F8E0EC',
                                	labelWidth: 80,
                                	emptyText: 'Double Click',
                                    listeners: {
                                        afterrender: function(c) {
                                        	c.getEl().on('dblclick', function() {
                                        		
                                        		if(Ext.getCmp('V_PO_CFM').getValue() != 'Y') {
                                        			var popup = Ext.create("M_PO_HSPF.view.WinMBpPop");
                                        			popup.show();
                                        			
                                        			Ext.getCmp('fieldType').setValue('textfield2');
                                        			var store = Ext.getStore('WinMBpPopStore');
                                        			store.removeAll();
                                        		} else {
                                        			Ext.Msg.alert('확인', '발주확정 내역입니다. 수정할 수 없습니다.');
                                        		}
                                            });
                                        }
                                    },
                                    editable: false
                                },
                                {
                                    xtype: 'combobox',
                                    flex: 1,
                                    id: 'V_CUR',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    margin: '0 0 0 30',
                                    fieldLabel: '화폐단위',
                                    labelWidth: 80,
                                    displayField: 'DTL_NM',
                                    valueField: 'DTL_CD',
                                    editable: false,
                                    fieldStyle: 'background-color: #F8E0EC',
                                    value: 'KRW',
                                    store: Ext.create('Ext.data.Store',{
                                  		autoLoad: true,
                                  		storeId: 'store1',
                                  		proxy: {
                                              type: 'ajax',
                                              extraParams: {
                                               	V_MAST_CD: 'BA04',
                                               	V_GRID: 'Y'
                                              },	
                                              api: {
                                                  read: '/HSPF01/common/sql/Combobox.jsp'
                                              },
                                              reader: {
                                                  type: 'json',
                                                  rootProperty: 'resultList'
                                              }
                                          }
                                  	}),
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_CUR_N',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    margin: '0 0 0 30',
                                    fieldLabel: '화폐단위',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                    xtype: 'combobox',
                                    id: 'V_IN_TERMS',
                                    flex: 1,
                                    margin: '0 0 0 30',
                                    fieldLabel: '가격조건',
                                    labelWidth: 80,
                                    displayField: 'DTL_NM',
                                    valueField: 'DTL_CD',
                                    editable: false,
                                    maxWidth: 300,
                                    minWidth: 300,
                                    width: 300,
                                    fieldStyle: 'background-color: #F8E0EC',
                                    value: 'AON',
                                    store: Ext.create('Ext.data.Store',{
                                  		autoLoad: true,
                                  		storeId: 'store1',
                                  		proxy: {
                                              type: 'ajax',
                                              extraParams: {
                                               	V_MAST_CD: 'MA04',
                                               	V_GRID: 'Y'
                                              },	
                                              api: {
                                                  read: '/HSPF01/common/sql/Combobox.jsp'
                                              },
                                              reader: {
                                                  type: 'json',
                                                  rootProperty: 'resultList'
                                              }
                                          }
                                  	}),
                                  	listConfig: {
                                        itemTpl: [
                                            '<div>{DTL_NM} ({DTL_CD})</div>'
                                        ],
                                    }
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_IN_TERMS_N',
                                    maxWidth: 300,
                                    minWidth: 300,
                                    width: 300,
                                    margin: '0 0 0 30',
                                    fieldLabel: '가격조건',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                    xtype: 'textfield',
                                    flex: 1,
                                    id: 'V_COMM_NO',
                                    margin: '0 0 0 30',
                                    maxWidth: 220,
                                    minWidth: 220,
                                    width: 220,
                                    fieldLabel: 'B/L번호',
                                    labelWidth: 80
                                },
                            ]
                        },
                        {
                            xtype: 'fieldcontainer',
                            layout: {
                                type: 'hbox',
                                align: 'stretch'
                            },
                            items: [
                                {
                                    xtype: 'combobox',
                                    flex: 1,
                                    id: 'V_PAY',
                                    maxWidth: 250,
                                    minWidth: 250,
                                    width: 250,
                                    matchFieldWidth: false,
                                    fieldLabel: '결제방법',
                                    labelWidth: 80,
                                    displayField: 'DTL_NM',
                                    valueField: 'DTL_CD',
                                    editable: false,
                                    fieldStyle: 'background-color: #F8E0EC',
                                    store: Ext.create('Ext.data.Store',{
                                  		autoLoad: true,
                                  		storeId: 'store1',
                                  		proxy: {
                                              type: 'ajax',
                                              extraParams: {
                                               	V_MAST_CD: 'MA03',
                                               	V_GRID: 'Y'
                                              },	
                                              api: {
                                                  read: '/HSPF01/common/sql/Combobox.jsp'
                                              },
                                              reader: {
                                                  type: 'json',
                                                  rootProperty: 'resultList'
                                              }
                                          }
                                  	}),
                                  	listConfig: {
                                        itemTpl: [
                                            '<div>{DTL_NM} ({DTL_CD})</div>'
                                        ]
                                    }
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_PAY_N',
                                    maxWidth: 250,
                                    minWidth: 250,
                                    width: 250,
                                    fieldLabel: '결제방법',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                    xtype: 'textfield',
                                    flex: 1,
                                    id: 'V_PO_CFM',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    fieldLabel: 'V_PO_CFM',
                                    labelWidth: 80,
                                    hidden: true
                                },
                                {
                                    xtype: 'combobox',
                                    flex: 1,
                                    id: 'V_DLV_TYPE',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    margin: '0 0 0 30',
                                    matchFieldWidth: false,
                                    fieldLabel: '입고구분',
                                    labelWidth: 80,
                                    displayField: 'DTL_NM',
                                    valueField: 'DTL_CD',
                                    editable: false,
                                    fieldStyle: 'background-color: #F8E0EC',
                                    store: Ext.create('Ext.data.Store',{
                                  		autoLoad: true,
                                  		storeId: 'store1',
                                  		proxy: {
                                              type: 'ajax',
                                              extraParams: {
                                               	V_MAST_CD: 'MA09',
                                               	V_GRID: 'Y'
                                              },	
                                              api: {
                                                  read: '/HSPF01/common/sql/Combobox.jsp'
                                              },
                                              reader: {
                                                  type: 'json',
                                                  rootProperty: 'resultList'
                                              }
                                          }
                                  	}),
                                  	listConfig: {
                                        itemTpl: [
                                            '<div>{DTL_NM} ({DTL_CD})</div>'
                                        ]
                                    }
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_DLV_TYPE_N',
                                    maxWidth: 200,
                                    minWidth: 200,
                                    width: 200,
                                    margin: '0 0 0 30',
                                    fieldLabel: '입고구분',
                                    labelWidth: 80,
                                    editable: false,
                                    hidden: true
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_REMARK',
                                	maxWidth: 300,
                                	minWidth: 300,
                                	width: 300,
                                	margin: '0 0 0 30',
                                	fieldLabel: '비고',
                                	labelWidth: 80,
                                	emptyText: '(관리자용)'
//                                	editable: false,
//                                	hidden: true
                                },
                                {
                                	xtype: 'textfield',
                                	id: 'V_S_BP_CD',
                                	maxWidth: 220,
                                	minWidth: 220,
                                	width: 220,
                                	margin: '0 0 0 30',
                                	fieldLabel: '고객사',
                                	labelWidth: 80,
                                	emptyText: '(직입고)',
                                	editable: false,
                                	emptyText: 'Double Click',
                                    listeners: {
                                        afterrender: function(c) {
                                        	c.getEl().on('dblclick', function() {
                                        		if(Ext.getCmp('V_DLV_TYPE').getValue() == 'B' || Ext.getCmp('V_DLV_TYPE').getValue() == 'E') {
                                        			var popup = Ext.create("Popup.view.WinSBpPop");
                                        			popup.show();
                                        			
                                        			Ext.getCmp('fieldType').setValue('M_PO_HSPF');
                                        			var store = Ext.getStore('WinSBpPopStore');
                                        			store.removeAll();
                                        		} else {
                                        			Ext.Msg.alert('확인', '입고구분이 직입고 또는 CY창고 시 선택가능합니다.');
                                        		}
                                            });
                                        }
                                    },
                                    editable: false
//                                	hidden: true
                                },
                            ]
                        }
                    ]
                }
            ]
        },
        {
            xtype: 'container',
            flex: 1,
            layout: 'fit',
            items: [
                {
                    xtype: 'gridpanel',
                    tbar: [
                        {
                            id: 'gridAddBtn1',
                            text: '',
                            margin: '0 3 0 0',
                            glyph: 'xf055@FontAwesome',
                            iconCls: 'grid-add-btn',
                        },
                        {
                            id: 'gridDelBtn1',
                            text: '',
                            margin: '0 3 0 0',
                            glyph: 'xf056@FontAwesome',
                            iconCls: 'grid-del-btn',
                        },
                        {
                            xtype: 'container',
                            flex: 1
                        },
                        {
                        	id: 'hstnPo',
                        	xtype: 'button',
                        	text: 'HSTN발주참조',
                        	margin: '0 3 0 0',
                        	cls: 'green-btn',
                        	style: 'background-color: white; border: 0.5px solid #009e12;',
                        	hidden: true
                        },
                        {
                            id: 'gridPoBtn1',
                            xtype: 'button',
                            text: '발주생성',
                            margin: '0 3 0 0',
                            cls: 'blue-btn',
                            style: 'background-color: white; border: 0.5px solid #3367d6;'
                        },
                        {
                        	id: 'gridPoSave',
                        	xtype: 'button',
                        	text: '발주저장',
                        	margin: '0 3 0 0',
                        	disabled: true,
                            cls: 'blue-btn',
                            style: 'background-color: white; border: 0.5px solid #3367d6;'
                        },
                        {
                        	xtype: 'button',
                            id: 'gridPoConfBtn',
                            text: '확정/취소',
                            margin: '0 3 0 0',
                            disabled: true,
                            cls: 'blue-btn',
                            style: 'background-color: white; border: 0.5px solid #3367d6;'
                        },
                        {
                        	xtype: 'button',
                            id: 'gridPoCancelBtn',
                            text: '발주취소',
                            margin: '0 3 0 0',
                            hidden: true
                        },
                        {
                            id: 'gridAllDelBtn',
                            xtype: 'button',
                            text: '전체삭제',
                            margin: '0 3 0 0',
                            hidden: true
                        },
                        {
                            xtype: 'button',
                            glyph: 'xf1c3@FontAwesome',
                            id: 'xlsxDown',
                            cfg: {
                                type: 'excel07',
                                ext: 'xlsx'
                            },
                            iconCls: 'grid-excel-btn',
                        }
                    ],
                    id: 'myGrid2',
                    margin: '-15 -15 0 -15',
                    padding: 10,
                    bodyBorder: false,
                    header: false,
                    store: 'MyStore1',
                    columns: [
                        {
                            xtype: 'rownumberer',
                            width: 40
                        },
                        {
                            xtype: 'gridcolumn',
                            hidden: true,
                            text: 'V_TYPE',
                            id: 'V_TYPE1',
                            dataIndex: 'V_TYPE'
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'text-align: center; font-weight: bold;',
                            dataIndex: 'PO_NO',
                            text: '발주번호',
                            width: 150,
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold;',
                            align: 'end',
                            dataIndex: 'PO_SEQ',
                            enableTextSelection: true,
                            exportStyle: {
                                format: 'Currency',
                                alignment: {
                                    horizontal: 'Right'
                                }
                            },
                            text: '발주순번',
                            format: '0,000',
                            width: 80,
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            dataIndex: 'ITEM_CD',
                            text: '품목코드',
                            editable: false,
                            width: 130,
                            editor: {
                                xtype: 'textfield',
                                allowBlank: false,
                                emptyText: 'Double Click',
                                editable: false,
                                listeners: {
                                    afterrender: function(c) {
                                    	c.getEl().on('dblclick', function() {
                                    		var popup = Ext.create("Popup.view.WinItemPop");
                                            popup.show();
                                            
                                            var store = Ext.getStore('WinItemPopStore');
                                    		store.removeAll();
                                    		
                                    		Ext.getCmp('W_TYPE').setValue('PO');
                                    		Ext.getCmp('W_M_BP_CD').setValue(Ext.getCmp('V_M_BP_CD2').getValue());
                                        });
                                    }
                                }
                            },
                            emptyCellText: '(입력)',
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'text-align: center; font-weight: bold;',
                            dataIndex: 'ITEM_NM',
                            text: '품목명',
	                        editable: false,
	                        width: 200
                        },
                        {
                        	xtype: 'numbercolumn',
                        	style: 'text-align: center; font-weight: bold; ',
                        	align: 'end',
                        	dataIndex: 'MIN_PO_QTY',
                        	enableTextSelection: true,
                        	text: '최소발주수량',
                        	renderer: function(value) {
                        		return Ext.util.Format.number(value, '0,000.00');
                        	}
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'PO_QTY',
                            enableTextSelection: true,
                            text: '수량',
                            editor: {
                                xtype: 'numberfield',
                                allowBlank: false,
                                allowExponential: false,
                                minValue: 0
                            },
                            emptyCellText: '(입력)',
                            renderer: function(value) {
                            	return Ext.util.Format.number(value, '0,000.00');
                            },
                            tdCls: 'x-change-cell' 	,	
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'PO_PRC',
                            enableTextSelection: true,
                            text: '단가',
                            editor: {
                                xtype: 'numberfield',
                                allowBlank: false,
                                allowExponential: false,
                                minValue: 0
                            },
                            renderer: function(value) {
                            	return Ext.util.Format.number(value, '0,000.00');
                            }
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold;',
                            align: 'end',
                            dataIndex: 'PO_AMT',
                            enableTextSelection: true,
                            text: '금액',
                            renderer: function(value) {
                            	return Ext.util.Format.number(value, '0,000.00');
                            }
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold;',
                            align: 'end',
                            dataIndex: 'PO_LOC_AMT',
                            enableTextSelection: true,
                            text: '자국금액',
                            renderer: function(value) {
                            	return Ext.util.Format.number(value, '0,000');
                            }
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'text-align: center; font-weight: bold; color: #3367d6',
                        	text: '<span style=\'color:red\'>*</span>부가세유형',
                        	dataIndex: 'VAT_TYPE',
                        	width: 200,
                        	align: 'left',
                        	
                        	editor: {
                        		xtype: 'combobox',
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		editable: false,
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'store1',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'BA05',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        	},
                        	renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('store1').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('store1').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                            emptyCellText: '(필수)',
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold;',
                            align: 'end',
                            dataIndex: 'PO_VAT_AMT',
                            enableTextSelection: true,
                            text: '부가세금액',
                            renderer: function(value) {
                            	return Ext.util.Format.number(Math.round(value), '0,000');
                            }
                        },
                        {
                            xtype: 'datecolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            align: 'center',
                            width: 140,
                            dataIndex: 'DLVY_HOPE_DT',
                            enableTextSelection: true,
                            exportStyle: {
                                format: 'Short Date'
                            },
                            text: '납기요청일',
                            format: 'Y-m-d',
                            editor: {
                                xtype: 'datefield',
                                format: 'Y-m-d',
                            },
                            emptyCellText: '(미입력시 자동계산)',
                        },
                        {
                            xtype: 'gridcolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            text: '<span style=\'color:red\'>*</span>납기요청창고',
                            width: 140,
                            dataIndex: 'HOPE_SL_CD',
                            editor: {
                        		xtype: 'combobox',
                        		editable: false,
                        		displayField: 'DTL_NM',
                        		autoLoadOnValue: true,
                        		valueField: 'DTL_CD',
                        		store: Ext.create('Ext.data.Store',{
                        			autoLoad: true,
                        			storeId: 'sl_combo',
                        			proxy: {
                        		           type: 'ajax',
                        		           extraParams: {
                        		            	V_MAST_CD: 'SL_G',
                        		            	V_GRID: 'Y'
                        		           },	
                        		           api: {
                        		               read: '/HSPF01/common/sql/Combobox.jsp'
                        		           },
                        		           reader: {
                        		               type: 'json',
                        		               rootProperty: 'resultList'
                        		           }
                        		       }
                        		}),
                        	},
                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                if(Ext.data.StoreManager.lookup('sl_combo').findRecord('DTL_CD',value) !==null)
                                {
                                    return Ext.data.StoreManager.lookup('sl_combo').findRecord('DTL_CD',value).get('DTL_NM');
                                }
                                return value;
                            },
                            emptyCellText: '(필수)',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	style: 'text-align: center; font-weight: bold; color: #3367d6',
                        	dataIndex: 'SUPP_REMARK',
                        	enableTextSelection: true,
                        	text: '비고(TO공급사)',
                        	width: 400,
                        	editor: {
                        		xtype: 'textfield',
                        	}
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'OVER_TOL',
                            enableTextSelection: true,
                            text: '허용률(+)',
                            format: '0,000.0000',
                            editor: {
                                xtype: 'numberfield',
                                minValue: 0
                            }
                        },
                        {
                            xtype: 'numbercolumn',
                            style: 'text-align: center; font-weight: bold; color: #3367d6',
                            align: 'end',
                            dataIndex: 'UNDER_TOL',
                            enableTextSelection: true,
                            text: '허용률(-)',
                            format: '0,000.000',
                            editor: {
                                xtype: 'numberfield',
                                minValue: 0
                            }
                        },
                        {
                            xtype: 'gridcolumn',
                            text: 'ERP전송유무',
                            dataIndex: 'ERP_TRANS_YN',
                            style: 'text-align: center; font-weight: bold;',
                            hidden: true
                        },
                        {
                            xtype: 'gridcolumn',
                            text: '구매요청번호',
                            dataIndex: 'PUR_NO',
                            style: 'text-align: center; font-weight: bold;',
                            width: 160	
                        },
                        {
                            xtype: 'gridcolumn',
                            text: '구매요청순번',
                            dataIndex: 'PUR_SEQ',
                            style: 'text-align: center; font-weight: bold;',
                        },
                        {
                        	xtype: 'gridcolumn',
                        	text: '요청번호',
                        	dataIndex: 'SO_NO',
                        	style: 'text-align: center; font-weight: bold;',
                        	width: 160	
                        },
                        {
                        	xtype: 'gridcolumn',
                        	text: '요청순번',
                        	dataIndex: 'SO_SEQ',
                        	style: 'text-align: center; font-weight: bold;',
                        }
                    ],
                    selModel: {
                        selType: 'checkboxmodel',
//                        checkOnly: true,
                        listeners: {
                        	select: function(rowmodel, record, index, eOpts) {
                            	record.set('V_TYPE', 'V');
                            },
                            deselect: function(rowmodel, record, index, eOpts) {
                            	record.set('V_TYPE', '');
                            }
                        }
                    },
                    plugins: [
                        {
                            ptype: 'gridexporter'
                        },
                        {
                            ptype: 'cellediting',
                            clicksToEdit: 1,
                            listeners: {
                            	edit: function(editor, context, eOpts) {
                            		
                            		var store1 = Ext.data.StoreManager.lookup('MyStore1');
                            		var selModel= Ext.getCmp('myGrid2').getSelectionModel();
                            		selModel.select(context.record, true);
                            		
                            		var VAT_TYPE = context.record.get('VAT_TYPE'); 
                                    var V_RATE = Ext.getCmp('V_RATE').getValue();
                                    
                            		/*부가세유형에 따른 부가세금액*/
                                    /*일반세금계산서*/
                                    if (VAT_TYPE == 'A') {
                            			// 부가세유형 변경시 다른 ROW도 일괄 변경합니다.
                            			store1.each(function(record,idx) {
                            				var PO_QTY = store1.getAt(idx).get('PO_QTY');
                                    		var PO_PRC = store1.getAt(idx).get('PO_PRC');
                            				var PO_AMT = store1.getAt(idx).get('PO_AMT');
                            				store1.getAt(idx).set('VAT_TYPE', 'A');
                            				store1.getAt(idx).set('PO_VAT_AMT', PO_AMT * 0.1); //부가세금액
                            				store1.getAt(idx).set('PO_LOC_AMT', PO_QTY * PO_PRC * V_RATE); //자국금액
                            			})
                                    } else {
                            			// 부가세유형 변경시 다른 ROW도 일괄 변경합니다.
	                                   	 store1.each(function(record,idx) {
	                                   		var PO_QTY = store1.getAt(idx).get('PO_QTY');
                                    		var PO_PRC = store1.getAt(idx).get('PO_PRC');
	                                   		store1.getAt(idx).set('VAT_TYPE', VAT_TYPE);
                            				store1.getAt(idx).set('PO_VAT_AMT', 0); //부가세금액
                            				store1.getAt(idx).set('PO_LOC_AMT', PO_QTY * PO_PRC * V_RATE); //자국금액
	                         			})
                                    };
                                    
                                    var gridRecord = Ext.getCmp('myGrid2').getSelectionModel().getSelection();
                                    if(gridRecord.length > 0) {
                                    	for(var i=0; i<gridRecord.length; i++) {
                                    		var PO_QTY = gridRecord[i].data['PO_QTY'];
                                    		var PO_PRC = gridRecord[i].data['PO_PRC']; 
                                    		var VAT_TYPE = gridRecord[i].data['VAT_TYPE']; 
                                    		
                                    		if( PO_QTY != undefined && PO_PRC != undefined && VAT_TYPE != undefined) {
                                    			gridRecord[i].set('PO_AMT', PO_QTY * PO_PRC);
                                    			gridRecord[i].set('PO_LOC_AMT', PO_QTY * PO_PRC * V_RATE);
                                    			if(VAT_TYPE == 'A') {
                                    				gridRecord[i].set('PO_VAT_AMT', PO_QTY * PO_PRC * V_RATE * 0.1);
                                    			} else {
                                    				gridRecord[i].set('PO_VAT_AMT', 0);
                                    			}
                                    		} else if ( PO_QTY != undefined && PO_PRC != undefined ) {
                                    			gridRecord[i].set('PO_AMT', PO_QTY * PO_PRC);
                                    			gridRecord[i].set('PO_LOC_AMT', PO_QTY * PO_PRC * V_RATE);
                                    		}
                                    	}
                                    }
                                    
                                    /*납기요청창고 일괄변경. 첫번째 row 수정시에만.*/
                                    if(context.field == 'HOPE_SL_CD' && context.rowIdx == 0) {
                                    	store1.each(function(rec, idx) {
                                    		rec.set('HOPE_SL_CD', context.value);
                                    	});
                                    } 
                            	},
                            	beforeedit: function(editor, context) {
                                    var V_PO_CFM = Ext.getCmp('V_PO_CFM').getValue();
                            		//확정상태 발주이면 발주상세내역 수정불가능.
                            		if (V_PO_CFM == 'Y') {
                            			context.cancel = true; 
                                    } else {
                                    	context.cancel = false; 
                                    }
                                }
                            }, 
                            
                        },
                    ],
                    viewConfig: {
                    	enableTextSelection: true,
                      	getRowClass: function(record, index) {
                            var MIN_PO_QTY = record.get('MIN_PO_QTY'); //최소발주량
                            var PO_QTY = record.get('PO_QTY'); //수량                            

                            if((MIN_PO_QTY != 0) && (Number(MIN_PO_QTY) > Number(PO_QTY))) {
                            	return 'bg-red'
                            }
                        },
                    },
                }
            ]
        }
    ]

});